/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 2.1.15 Copyright (c) 2010-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/**
 * @license RequireJS domReady 2.0.1 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/domReady for details
 */

/*!
 * EventEmitter2
 * https://github.com/hij1nx/EventEmitter2
 *
 * Copyright (c) 2013 hij1nx
 * Licensed under the MIT license.
 */

/**
 * The license for this file's source code is included here as required:
 *
The MIT License (MIT)

Copyright (c) 2015 Valentin Allaire <valentin.allaire@sitexw.fr>

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
 *
 */

var ctRequire;(function(){if(!ctRequire||!ctRequire.requirejs){ctRequire?require=ctRequire:ctRequire={};var requirejs,require,define;(function(global){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function each(e,t){if(e){var n;for(n=0;n<e.length;n+=1)if(e[n]&&t(e[n],n,e))break}}function eachReverse(e,t){if(e){var n;for(n=e.length-1;n>-1;n-=1)if(e[n]&&t(e[n],n,e))break}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var n;for(n in e)if(hasProp(e,n)&&t(e[n],n))break}function mixin(e,t,n,r){return t&&eachProp(t,function(t,i){if(n||!hasProp(e,i))r&&typeof t=="object"&&t&&!isArray(t)&&!isFunction(t)&&!(t instanceof RegExp)?(e[i]||(e[i]={}),mixin(e[i],t,n,r)):e[i]=t}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,n,r){var i=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=r,n&&(i.originalError=n),i}function newContext(e){function m(e){var t,n;for(t=0;t<e.length;t++){n=e[t];if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===0||t==1&&e[2]===".."||e[t-1]==="..")continue;t>0&&(e.splice(t-1,2),t-=2)}}}function g(e,t,n){var r,i,s,u,a,f,l,c,h,p,d,v,g=t&&t.split("/"),y=o.map,b=y&&y["*"];e&&(e=e.split("/"),l=e.length-1,o.nodeIdCompat&&jsSuffixRegExp.test(e[l])&&(e[l]=e[l].replace(jsSuffixRegExp,"")),e[0].charAt(0)==="."&&g&&(v=g.slice(0,g.length-1),e=v.concat(e)),m(e),e=e.join("/"));if(n&&y&&(g||b)){s=e.split("/");e:for(u=s.length;u>0;u-=1){f=s.slice(0,u).join("/");if(g)for(a=g.length;a>0;a-=1){i=getOwn(y,g.slice(0,a).join("/"));if(i){i=getOwn(i,f);if(i){c=i,h=u;break e}}}!p&&b&&getOwn(b,f)&&(p=getOwn(b,f),d=u)}!c&&p&&(c=p,h=d),c&&(s.splice(0,h,c),e=s.join("/"))}return r=getOwn(o.pkgs,e),r?r:e}function y(e){isBrowser&&each(scripts(),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===r.contextName)return t.parentNode.removeChild(t),!0})}function b(e){var t=getOwn(o.paths,e);if(t&&isArray(t)&&t.length>1)return t.shift(),r.require.undef(e),r.makeRequire(null,{skipMap:!0})([e]),!0}function w(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e,t,n,i){var s,o,u,a,f=null,l=t?t.name:null,h=e,p=!0,m="";return e||(p=!1,e="_@r"+(d+=1)),a=w(e),f=a[0],e=a[1],f&&(f=g(f,l,i),o=getOwn(c,f)),e&&(f?o&&o.normalize?m=o.normalize(e,function(e){return g(e,l,i)}):m=e.indexOf("!")===-1?g(e,l,i):e:(m=g(e,l,i),a=w(m),f=a[0],m=a[1],n=!0,s=r.nameToUrl(m))),u=f&&!o&&!n?"_unnormalized"+(v+=1):"",{prefix:f,name:m,parentMap:t,unnormalized:!!u,url:s,originalName:h,isDefine:p,id:(f?f+"!"+m:m)+u}}function S(e){var t=e.id,n=getOwn(u,t);return n||(n=u[t]=new r.Module(e)),n}function x(e,t,n){var r=e.id,i=getOwn(u,r);hasProp(c,r)&&(!i||i.defineEmitComplete)?t==="defined"&&n(c[r]):(i=S(e),i.error&&t==="error"?n(i.error):i.on(t,n))}function T(e,t){var n=e.requireModules,r=!1;t?t(e):(each(n,function(t){var n=getOwn(u,t);n&&(n.error=e,n.events.error&&(r=!0,n.emit("error",e)))}),r||req.onError(e))}function N(){globalDefQueue.length&&(apsp.apply(l,[l.length,0].concat(globalDefQueue)),globalDefQueue=[])}function C(e){delete u[e],delete a[e]}function k(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,each(e.depMaps,function(r,i){var s=r.id,o=getOwn(u,s);o&&!e.depMatched[i]&&!n[s]&&(getOwn(t,s)?(e.defineDep(i,c[s]),e.check()):k(o,t,n))}),n[r]=!0)}function L(){var e,n,i=o.waitSeconds*1e3,u=i&&r.startTime+i<(new Date).getTime(),f=[],l=[],c=!1,h=!0;if(t)return;t=!0,eachProp(a,function(e){var t=e.map,r=t.id;if(!e.enabled)return;t.isDefine||l.push(e);if(!e.error)if(!e.inited&&u)b(r)?(n=!0,c=!0):(f.push(r),y(r));else if(!e.inited&&e.fetched&&t.isDefine){c=!0;if(!t.prefix)return h=!1}});if(u&&f.length)return e=makeError("timeout","Load timeout for modules: "+f,null,f),e.contextName=r.contextName,T(e);h&&each(l,function(e){k(e,{},{})}),(!u||n)&&c&&(isBrowser||isWebWorker)&&!s&&(s=setTimeout(function(){s=0,L()},50)),t=!1}function A(e){hasProp(c,e[0])||S(E(e[0],null,!0)).init(e[1],e[2])}function O(e,t,n,r){e.detachEvent&&!isOpera?r&&e.detachEvent(r,t):e.removeEventListener(n,t,!1)}function M(e){var t=e.currentTarget||e.srcElement;return O(t,r.onScriptLoad,"load","onreadystatechange"),O(t,r.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function _(){var e;N();while(l.length){e=l.shift();if(e[0]===null)return T(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));A(e)}}var t,n,r,i,s,o={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},u={},a={},f={},l=[],c={},h={},p={},d=1,v=1;return i={require:function(e){return e.require?e.require:e.require=r.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?c[e.map.id]=e.exports:e.exports=c[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){return getOwn(o.config,e.map.id)||{}},exports:e.exports||(e.exports={})}}},n=function(e){this.events=getOwn(f,e.id)||{},this.map=e,this.shim=getOwn(o.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},n.prototype={init:function(e,t,n,r){r=r||{};if(this.inited)return;this.factory=t,n?this.on("error",n):this.events.error&&(n=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check()},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(this.fetched)return;this.fetched=!0,r.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();r.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()}))},load:function(){var e=this.map.url;h[e]||(h[e]=!0,r.load(this.map.id,e))},check:function(){if(!this.enabled||this.enabling)return;var e,t,n=this.map.id,i=this.depExports,s=this.exports,o=this.factory;if(!this.inited)this.fetch();else if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{s=r.execCb(n,o,i,s)}catch(u){e=u}else s=r.execCb(n,o,i,s);this.map.isDefine&&s===undefined&&(t=this.module,t?s=t.exports:this.usingExports&&(s=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",T(this.error=e)}else s=o;this.exports=s,this.map.isDefine&&!this.ignore&&(c[n]=s,req.onResourceLoad&&req.onResourceLoad(r,this.map,this.depMaps)),C(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}},callPlugin:function(){var e=this.map,t=e.id,n=E(e.prefix);this.depMaps.push(n),x(n,"defined",bind(this,function(n){var i,s,a,f=getOwn(p,this.map.id),l=this.map.name,c=this.map.parentMap?this.map.parentMap.name:null,h=r.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){n.normalize&&(l=n.normalize(l,function(e){return g(e,c,!0)})||""),s=E(e.prefix+"!"+l,this.map.parentMap),x(s,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),a=getOwn(u,s.id),a&&(this.depMaps.push(s),this.events.error&&a.on("error",bind(this,function(e){this.emit("error",e)})),a.enable());return}if(f){this.map.url=r.nameToUrl(f),this.load();return}i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(u,function(e){e.map.id.indexOf(t+"_unnormalized")===0&&C(e.map.id)}),T(e)}),i.fromText=bind(this,function(n,s){var u=e.name,a=E(u),f=useInteractive;s&&(n=s),f&&(useInteractive=!1),S(a),hasProp(o.config,t)&&(o.config[u]=o.config[t]);try{req.exec(n)}catch(l){return T(makeError("fromtexteval","fromText eval for "+t+" failed: "+l,l,[t]))}f&&(useInteractive=!0),this.depMaps.push(a),r.completeLoad(u),h([u],i)}),n.load(e.name,h,i,o)})),r.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){a[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var n,s,o;if(typeof e=="string"){e=E(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,o=getOwn(i,e.id);if(o){this.depExports[t]=o(this);return}this.depCount+=1,x(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&x(e,"error",bind(this,this.errback))}n=e.id,s=u[n],!hasProp(i,n)&&s&&!s.enabled&&r.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(u,e.id);t&&!t.enabled&&r.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),e==="error"&&delete this.events[e]}},r={config:o,contextName:e,registry:u,defined:c,urlFetched:h,defQueue:l,Module:n,makeModuleMap:E,nextTick:req.nextTick,onError:T,configure:function(e){e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/");var t=o.shim,n={paths:!0,bundles:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?(o[t]||(o[t]={}),mixin(o[t],e,!0,!0)):o[t]=e}),e.bundles&&eachProp(e.bundles,function(e,t){each(e,function(e){e!==t&&(p[e]=t)})}),e.shim&&(eachProp(e.shim,function(e,n){isArray(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=r.makeShimExports(e)),t[n]=e}),o.shim=t),e.packages&&each(e.packages,function(e){var t,n;e=typeof e=="string"?{name:e}:e,n=e.name,t=e.location,t&&(o.paths[n]=e.location),o.pkgs[n]=e.name+"/"+(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(u,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=E(t))}),(e.deps||e.callback)&&r.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,n){function s(o,a,f){var l,h,p;return n.enableBuildCallback&&a&&isFunction(a)&&(a.__requireJsBuild=!0),typeof o=="string"?isFunction(a)?T(makeError("requireargs","Invalid require call"),f):t&&hasProp(i,o)?i[o](u[t.id]):req.get?req.get(r,o,t,s):(h=E(o,t,!1,!0),l=h.id,hasProp(c,l)?c[l]:T(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(_(),r.nextTick(function(){_(),p=S(E(null,t)),p.skipMap=n.skipMap,p.init(o,a,f,{enabled:!0}),L()}),s)}return n=n||{},mixin(s,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),s=e.split("/")[0],o=s==="."||s==="..";return i!==-1&&(!o||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),r.nameToUrl(g(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(c,E(e,t,!1,!0).id)},specified:function(e){return e=E(e,t,!1,!0).id,hasProp(c,e)||hasProp(u,e)}}),t||(s.undef=function(e){N();var n=E(e,t,!0),r=getOwn(u,e);y(e),delete c[e],delete h[n.url],delete f[e],eachReverse(l,function(t,n){t[0]===e&&l.splice(n,1)}),r&&(r.events.defined&&(f[e]=r.events),C(e))}),s},enable:function(e){var t=getOwn(u,e.id);t&&S(e).enable()},completeLoad:function(e){var t,n,r,i=getOwn(o.shim,e)||{},s=i.exports;N();while(l.length){n=l.shift();if(n[0]===null){n[0]=e;if(t)break;t=!0}else n[0]===e&&(t=!0);A(n)}r=getOwn(u,e);if(!t&&!hasProp(c,e)&&r&&!r.inited){if(o.enforceDefine&&(!s||!getGlobal(s))){if(b(e))return;return T(makeError("nodefine","No define call for "+e,null,[e]))}A([e,i.deps||[],i.exportsFn])}L()},nameToUrl:function(e,t,n){var i,s,u,a,f,l,c,h=getOwn(o.pkgs,e);h&&(e=h),c=getOwn(p,e);if(c)return r.nameToUrl(c,t,n);if(req.jsExtRegExp.test(e))f=e+(t||"");else{i=o.paths,s=e.split("/");for(u=s.length;u>0;u-=1){a=s.slice(0,u).join("/"),l=getOwn(i,a);if(l){isArray(l)&&(l=l[0]),s.splice(0,u,l);break}}f=s.join("/"),f+=t||(/^data\:|\?/.test(f)||n?"":".js"),f=(f.charAt(0)==="/"||f.match(/^[\w\+\.\-]+:/)?"":o.baseUrl)+f}return o.urlArgs?f+((f.indexOf("?")===-1?"?":"&")+o.urlArgs):f},load:function(e,t){req.load(r,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if(e.type==="load"||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=M(e);r.completeLoad(t.id)}},onScriptError:function(e){var t=M(e);if(!b(t.id))return T(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},r.require=r.makeRequire(),r}function getInteractiveScript(){return interactiveScript&&interactiveScript.readyState==="interactive"?interactiveScript:(eachReverse(scripts(),function(e){if(e.readyState==="interactive")return interactiveScript=e}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.15",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=typeof window!="undefined"&&typeof navigator!="undefined"&&!!window.document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t,n,r){var i,s,o=defContextName;return!isArray(e)&&typeof e!="string"&&(s=e,isArray(t)?(e=t,t=n,n=r):e=[]),s&&s.context&&(o=s.context),i=getOwn(contexts,o),i||(i=contexts[o]=req.s.newContext(o)),s&&i.configure(s),i.require(e,t,n)},req.config=function(e){return req(e)},req.nextTick=typeof setTimeout!="undefined"?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e,t,n){var r=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return r.type=e.scriptType||"text/javascript",r.charset="utf-8",r.async=!0,r},req.load=function(e,t,n){var r=e&&e.config||{},i;if(isBrowser)return i=req.createNode(r,t,n),i.setAttribute("data-requirecontext",e.contextName),i.setAttribute("data-requiremodule",t),i.attachEvent&&!(i.attachEvent.toString&&i.attachEvent.toString().indexOf("[native code")<0)&&!isOpera?(useInteractive=!0,i.attachEvent("onreadystatechange",e.onScriptLoad)):(i.addEventListener("load",e.onScriptLoad,!1),i.addEventListener("error",e.onScriptError,!1)),i.src=n,currentlyAddingScript=i,baseElement?head.insertBefore(i,baseElement):head.appendChild(i),currentlyAddingScript=null,i;if(isWebWorker)try{importScripts(n),e.completeLoad(t)}catch(s){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+n,s,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){head||(head=e.parentNode),dataMain=e.getAttribute("data-main");if(dataMain)return mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0}),define=function(e,t,n){var r,i;typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=null),!t&&isFunction(n)&&(t=[],n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)})(this),ctRequire.requirejs=requirejs,ctRequire.require=require,ctRequire.define=define}})(),ctRequire.define("requireLib",function(){}),ctRequire.define("utils/dom_ready",[],function(){function u(e){var t;for(t=0;t<e.length;t+=1)e[t](s)}function a(){var e=o;i&&e.length&&(o=[],u(e))}function f(){i||(i=!0,n&&clearInterval(n),a())}function c(e){return i?e(s):o.push(e),c}var e,t,n,r=typeof window!="undefined"&&window.document,i=!r,s=r?document:null,o=[];if(r){if(document.addEventListener)document.addEventListener("DOMContentLoaded",f,!1),window.addEventListener("load",f,!1);else if(window.attachEvent){window.attachEvent("onload",f),t=document.createElement("div");try{e=window.frameElement===null}catch(l){}t.doScroll&&e&&window.external&&(n=setInterval(function(){try{t.doScroll(),f()}catch(e){}},30))}document.readyState==="complete"&&f()}return c.version="2.0.1",c.load=function(e,t,n,r){r.isBuild?n(null):c(n)},c}),ctRequire.define("jquery-private",["jquery"],function(e){var t=e.noConflict(!1);return window.$===undefined&&(window.$=t),t}),ctRequire.define("config/config",[],function(){var e={};return e.SDK_VERSION="0.0.1",e.DEFAULT_CONFIG=!0,e.BRAINTREE_ENV="production",e.CONNECT_BASE="//connect.cointent.com",e.CONNECT_URI="http:"+e.CONNECT_BASE,e.API_BASE="//api.cointent.com",e.API_PRODUCTION_BASE="//api.cointent.com",e.API_SANDBOX_BASE="//api.sandbox.cointent.com",e.API_URI="https:"+e.API_BASE,e.VIDEO_API_BASE="//api.videotent.com",e.SITE_URI="https://cointent.com",e.MIXPANEL_TOKEN="f3bddb5bc3712697790a9cd772cc2437",e.KEEN_PROJECTID="52cb097836bf5a6994000003",e.KEEN_WRITEKEY="62ab571ce01a1c3b8cde87270b706d1064c84d731834906fb5ae2e0864a405c88cffb233234877ff55e1c01496714d979a054e9bc0d7c5a61a1e3bf8a81e4b37631809f5e4b1e14f69ce5302a2d839a239f42f759e6cee04a9ff8a797d4eafb3094c5657b3d7716b794a5be19532ef4e",e}),!function(e){function r(){this._events={},this._conf&&i.call(this,this._conf)}function i(e){e&&(this._conf=e,e.delimiter&&(this.delimiter=e.delimiter),e.maxListeners&&(this._events.maxListeners=e.maxListeners),e.wildcard&&(this.wildcard=e.wildcard),e.newListener&&(this.newListener=e.newListener),this.wildcard&&(this.listenerTree={}))}function s(e){this._events={},this.newListener=!1,i.call(this,e)}function o(e,t,n,r){if(!n)return[];var i=[],s,u,a,f,l,c,h,p=t.length,d=t[r],v=t[r+1];if(r===p&&n._listeners){if(typeof n._listeners=="function")return e&&e.push(n._listeners),[n];for(s=0,u=n._listeners.length;s<u;s++)e&&e.push(n._listeners[s]);return[n]}if(d==="*"||d==="**"||n[d]){if(d==="*"){for(a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(i=i.concat(o(e,t,n[a],r+1)));return i}if(d==="**"){h=r+1===p||r+2===p&&v==="*",h&&n._listeners&&(i=i.concat(o(e,t,n,p)));for(a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(a==="*"||a==="**"?(n[a]._listeners&&!h&&(i=i.concat(o(e,t,n[a],p))),i=i.concat(o(e,t,n[a],r))):a===v?i=i.concat(o(e,t,n[a],r+2)):i=i.concat(o(e,t,n[a],r)));return i}i=i.concat(o(e,t,n[d],r+1))}f=n["*"],f&&o(e,t,f,r+1),l=n["**"];if(l)if(r<p){l._listeners&&o(e,t,l,p);for(a in l)a!=="_listeners"&&l.hasOwnProperty(a)&&(a===v?o(e,t,l[a],r+2):a===d?o(e,t,l[a],r+1):(c={},c[a]=l[a],o(e,t,{"**":c},r+1)))}else l._listeners?o(e,t,l,p):l["*"]&&l["*"]._listeners&&o(e,t,l["*"],p);return i}function u(e,r){e=typeof e=="string"?e.split(this.delimiter):e.slice();for(var i=0,s=e.length;i+1<s;i++)if(e[i]==="**"&&e[i+1]==="**")return;var o=this.listenerTree,u=e.shift();while(u){o[u]||(o[u]={}),o=o[u];if(e.length===0){if(!o._listeners)o._listeners=r;else if(typeof o._listeners=="function")o._listeners=[o._listeners,r];else if(t(o._listeners)){o._listeners.push(r);if(!o._listeners.warned){var a=n;typeof this._events.maxListeners!="undefined"&&(a=this._events.maxListeners),a>0&&o._listeners.length>a&&(o._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",o._listeners.length),console.trace())}}return!0}u=e.shift()}return!0}var t=Array.isArray?Array.isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},n=10;s.prototype.delimiter=".",s.prototype.setMaxListeners=function(e){this._events||r.call(this),this._events.maxListeners=e,this._conf||(this._conf={}),this._conf.maxListeners=e},s.prototype.event="",s.prototype.once=function(e,t){return this.many(e,1,t),this},s.prototype.many=function(e,t,n){function i(){--t===0&&r.off(e,i),n.apply(this,arguments)}var r=this;if(typeof n!="function")throw new Error("many only accepts instances of Function");return i._origin=n,this.on(e,i),r},s.prototype.emit=function(){this._events||r.call(this);var e=arguments[0];if(e==="newListener"&&!this.newListener&&!this._events.newListener)return!1;if(this._all){var t=arguments.length,n=new Array(t-1);for(var i=1;i<t;i++)n[i-1]=arguments[i];for(i=0,t=this._all.length;i<t;i++)this.event=e,this._all[i].apply(this,n)}if(e==="error"&&!this._all&&!this._events.error&&(!this.wildcard||!this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var s;if(this.wildcard){s=[];var u=typeof e=="string"?e.split(this.delimiter):e.slice();o.call(this,s,u,this.listenerTree,0)}else s=this._events[e];if(typeof s=="function"){this.event=e;if(arguments.length===1)s.call(this);else if(arguments.length>1)switch(arguments.length){case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:var t=arguments.length,n=new Array(t-1);for(var i=1;i<t;i++)n[i-1]=arguments[i];s.apply(this,n)}return!0}if(s){var t=arguments.length,n=new Array(t-1);for(var i=1;i<t;i++)n[i-1]=arguments[i];var a=s.slice();for(var i=0,t=a.length;i<t;i++)this.event=e,a[i].apply(this,n);return a.length>0||!!this._all}return!!this._all},s.prototype.on=function(e,i){if(typeof e=="function")return this.onAny(e),this;if(typeof i!="function")throw new Error("on only accepts instances of Function");this._events||r.call(this),this.emit("newListener",e,i);if(this.wildcard)return u.call(this,e,i),this;if(!this._events[e])this._events[e]=i;else if(typeof this._events[e]=="function")this._events[e]=[this._events[e],i];else if(t(this._events[e])){this._events[e].push(i);if(!this._events[e].warned){var s=n;typeof this._events.maxListeners!="undefined"&&(s=this._events.maxListeners),s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}return this},s.prototype.onAny=function(e){if(typeof e!="function")throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(e),this},s.prototype.addListener=s.prototype.on,s.prototype.off=function(e,n){if(typeof n!="function")throw new Error("removeListener only takes instances of Function");var r,i=[];if(this.wildcard){var s=typeof e=="string"?e.split(this.delimiter):e.slice();i=o.call(this,null,s,this.listenerTree,0)}else{if(!this._events[e])return this;r=this._events[e],i.push({_listeners:r})}for(var u=0;u<i.length;u++){var a=i[u];r=a._listeners;if(t(r)){var f=-1;for(var l=0,c=r.length;l<c;l++)if(r[l]===n||r[l].listener&&r[l].listener===n||r[l]._origin&&r[l]._origin===n){f=l;break}if(f<0)continue;return this.wildcard?a._listeners.splice(f,1):this._events[e].splice(f,1),r.length===0&&(this.wildcard?delete a._listeners:delete this._events[e]),this}if(r===n||r.listener&&r.listener===n||r._origin&&r._origin===n)this.wildcard?delete a._listeners:delete this._events[e]}return this},s.prototype.offAny=function(e){var t=0,n=0,r;if(e&&this._all&&this._all.length>0){r=this._all;for(t=0,n=r.length;t<n;t++)if(e===r[t])return r.splice(t,1),this}else this._all=[];return this},s.prototype.removeListener=s.prototype.off,s.prototype.removeAllListeners=function(e){if(arguments.length===0)return!this._events||r.call(this),this;if(this.wildcard){var t=typeof e=="string"?e.split(this.delimiter):e.slice(),n=o.call(this,null,t,this.listenerTree,0);for(var i=0;i<n.length;i++){var s=n[i];s._listeners=null}}else{if(!this._events[e])return this;this._events[e]=null}return this},s.prototype.listeners=function(e){if(this.wildcard){var n=[],i=typeof e=="string"?e.split(this.delimiter):e.slice();return o.call(this,n,i,this.listenerTree,0),n}return this._events||r.call(this),this._events[e]||(this._events[e]=[]),t(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},s.prototype.listenersAny=function(){return this._all?this._all:[]},typeof ctRequire.define=="function"&&ctRequire.define.amd?ctRequire.define("utils/events",[],function(){return s}):typeof exports=="object"?exports.EventEmitter2=s:window.EventEmitter2=s}(),ctRequire.define("utils/gumshoe",["jquery"],function(e){var t=function(e){this._options={checkOnLoad:!1,resetOnEnd:!1,loopCheckTime:50,loopMaxNumber:5,baitId:["ad_test"],baitClass:"img_ad ad_300x250 pub_300x250 pub_300x250m pub_728x90 text-ad textAd text_ad text_ads text-ads text-ad-links adsbygoogle act-ad-container",baitStyle:"width: 1px !important; height: 1px !important; position: absolute !important; left: -10000px !important; top: -1000px !important;",debug:!1},this._var={version:"3.2.0",bait:null,baitIds:[],checking:!1,loop:null,loopNumber:0,firefoxBait:null,event:{detected:[],notDetected:[]}},e!==undefined&&this.setOption(e);var t=this,n=function(){setTimeout(function(){t._options.checkOnLoad===!0&&(t._options.debug===!0&&t._log("onload->eventCallback","A check loading is launched"),t._var.bait===null&&t._creatBait(),setTimeout(function(){t.check()},1))},1)};window.addEventListener!==undefined?window.addEventListener("load",n,!1):window.attachEvent("onload",n)};t.prototype._options=null,t.prototype._var=null,t.prototype._bait=null,t.prototype._log=function(e,t){console.log("[Gumshoe]["+e+"] "+t)},t.prototype.setOption=function(e,t){if(t!==undefined){var n=e;e={},e[n]=t}for(var r in e)this._options[r]=e[r],this._options.debug===!0&&this._log("setOption",'The option "'+r+'" he was assigned to "'+e[r]+'"');return this},t.prototype._creatBait=function(){var e=document.createElement("div");e.setAttribute("class",this._options.baitClass),e.setAttribute("style",this._options.baitStyle),this._var.bait=window.document.body.appendChild(e),this._var.bait.offsetParent,this._var.bait.offsetHeight,this._var.bait.offsetLeft,this._var.bait.offsetTop,this._var.bait.offsetWidth,this._var.bait.clientHeight,this._var.bait.clientWidth;for(var t=0;t<this._options.baitId.length;t++)e=document.createElement("div"),e.setAttribute("id",this._options.baitId[t]),e.setAttribute("style",this._options.baitStyle),this._var.baitIds.push(e),window.document.body.appendChild(e),e.offsetParent,e.offsetHeight,e.offsetLeft,e.offsetTop,e.offsetWidth,e.clientHeight,e.clientWidth;this._options.debug===!0&&this._log("_creatBait","Bait has been created")},t.prototype._destroyBait=function(){try{window.document.body.removeChild(this._var.bait)}catch(e){this._log("_destroyBait","Bait cannot be removed it does not exist")}this._var.bait=null;for(var t=0;t<this._var.baitIds.length;t++)window.document.body.removeChild(this._var.baitIds[t]);this._var.baitIds=[],this._options.debug===!0&&this._log("_destroyBait","Bait has been removed")},t.prototype.check=function(e){e===undefined&&(e=!0),this._options.debug===!0&&this._log("check","An audit was requested "+(e===!0?"with a":"without")+" loop");if(this._var.checking===!0)return this._options.debug===!0&&this._log("check","A check was canceled because there is already an ongoing"),!1;this._var.checking=!0,this._var.bait===null&&this._creatBait();var t=this;return this._var.loopNumber=0,e===!0&&(this._var.loop=setInterval(function(){t._checkBait(e)},this._options.loopCheckTime)),setTimeout(function(){t._checkBait(e)},1),this._options.debug===!0&&this._log("check","A check is in progress ..."),!0},t.prototype._checkBait=function(t){var n=!1,r=this;this._var.bait===null&&this._creatBait();if(window.document.body.getAttribute("abp")!==null||this._var.bait.offsetParent===null||this._var.bait.offsetHeight==0||this._var.bait.offsetLeft==0||this._var.bait.offsetTop==0||this._var.bait.offsetWidth==0||this._var.bait.clientHeight==0||this._var.bait.clientWidth==0)n=!0;for(var i=0;i<this._var.baitIds.length;i++){var s=this._var.baitIds[i];if(s.offsetParent===null||s.offsetHeight==0||s.offsetLeft==0||s.offsetTop==0||s.offsetWidth==0||s.clientHeight==0||s.clientWidth==0||!e(s).is(":visible"))n=!0}if(window.getComputedStyle!==undefined){var o=window.getComputedStyle(this._var.bait,null);if(o.getPropertyValue("display")=="none"||o.getPropertyValue("visibility")=="hidden")n=!0}this._options.debug===!0&&this._log("_checkBait","A check ("+(this._var.loopNumber+1)+"/"+this._options.loopMaxNumber+" ~"+(1+this._var.loopNumber*this._options.loopCheckTime)+"ms) was conducted and detection is "+(n===!0?"positive":"negative")),t===!0&&(this._var.loopNumber++,this._var.loopNumber>=this._options.loopMaxNumber&&this._stopLoop());if(n===!0)this._stopLoop(),this._destroyBait(),this.emitEvent(!0),t===!0&&(this._var.checking=!1);else if(this._var.loop===null||t===!1)r._destroyBait(),r.emitEvent(!1),t===!0&&(r._var.checking=!1)},t.prototype._stopLoop=function(e){clearInterval(this._var.loop),this._var.loop=null,this._var.loopNumber=0,this._options.debug===!0&&this._log("_stopLoop","A loop has been stopped")},t.prototype.emitEvent=function(e){this._options.debug===!0&&this._log("emitEvent","An event with a "+(e===!0?"positive":"negative")+" detection was called");var t=this._var.event[e===!0?"detected":"notDetected"];for(var n in t)this._options.debug===!0&&this._log("emitEvent","Call function "+(parseInt(n)+1)+"/"+t.length),t.hasOwnProperty(n)&&t[n]();return this._options.resetOnEnd===!0&&this.clearEvent(),this},t.prototype.clearEvent=function(){this._var.event.detected=[],this._var.event.notDetected=[],this._options.debug===!0&&this._log("clearEvent","The event list has been cleared")},t.prototype.on=function(e,t){return this._var.event[e===!0?"detected":"notDetected"].push(t),this._options.debug===!0&&this._log("on",'A type of event "'+(e===!0?"detected":"notDetected")+'" was added'),this},t.prototype.onDetected=function(e){return this.on(!0,e)},t.prototype.onNotDetected=function(e){return this.on(!1,e)};var n=new t({checkOnLoad:!0,resetOnEnd:!0});return n}),ctRequire.define("utils/utils",["require","jquery-private","config/config","utils/events","utils/gumshoe"],function(e,t,n,r,i){Date.now=Date.now||function(){return+(new Date)},window.cointent_startTime=Date.now();var s={},o="click touchstart";return s.emitter=new r,s.articlePrices={},s.articlePromoCodes={},s.auth=undefined,s.userIdMaybe=null,s.linkToken=null,s.debugger=!1,s.firefoxRecheck=!0,s.parsedAsIE||(s.parsedAsIE=null),s.parsedAsSafari||(s.parsedAsSafari=null),s.parsedAsMobile||(s.parsedAsMobile=null),s.getCurrencySymbol=function(e){var t="&#36;";switch(e){case"GBP":t="&#163;";break;case"EUR":t="&#128;";break;case"CAD":t="C&#36;";break;case"AUD":t="AU&#36;";break;case"USD":default:t="&#36;"}return t},s.formatCostForButton=function(e,t){var n;return e===0?n="Free":n=this.getCurrencySymbol(t)+parseFloat(e).toFixed(2),n},s.formatDollarsForDisplay=function(e){return"$"+(Math.round(e*100)/100).toFixed(2)},s.formatEmailForDisplay=function(e){var t=e.split("@");return t[0]&&(t[0].length>=6?t[0]=t[0].substring(0,t[0].length-3):t[0]=t[0].substring(0,Math.min(3,t[0].length)),t[0]+="..."),t.join("@")},s.addEventListener=function(e,t){window.addEventListener?window.addEventListener(e,t,!1):window.attachEvent&&window.attachEvent(e,t,!1)},s.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)},s.isFirefox=function(){return typeof InstallTrigger!="undefined"},s.isInternetExplorer=function(){if(this.parsedAsIE!==!0&&this.parsedAsIE!==!1){var e=!1,t=navigator.userAgent,n=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");n.exec(t)!==null?e=!0:(n=new RegExp("Trident/([0-9]{1,}[.0-9]{0,})"),n.exec(t)!==null&&(e=!0)),this.parsedAsIE=e}return this.parsedAsIE},s.isIE8=function(){var e=navigator.userAgent,t=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})"),n=0;return t.exec(e)!=null&&(n=parseFloat(RegExp.$1)),n===8},s.isChrome=function(){var e=!1;if(this.parsedAsSafari!==!0){var t=navigator.userAgent,n=new RegExp("Chrome/([.0-9]+).*");n.exec(t)!==null&&(e=!0)}return e},s.isSafari=function(){if(this.parsedAsSafari!==!0&&this.parsedAsSafari!==!1){var e=!1,t=navigator.userAgent,n=new RegExp("Chrome/([.0-9]+).*");if(n.exec(t)===null){var r=new RegExp("Version/([.0-9]+)[^()]+Safari/.*");r.exec(t)!==null&&(e=!0),r=new RegExp("FBMD/[A-Za-z]+;"),r.exec(t)!==null&&(e=!0),r=new RegExp("iPhone OS"),r.exec(t)!==null&&(e=!0)}this.parsedAsSafari=e}return this.parsedAsSafari},s.isMobile=function(){return this.parsedAsMobile===null&&(this.parsedAsMobile=/Android|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent||navigator.vendor||window.opera)),this.parsedAsMobile},s.parseSessionUtm=function(e){var t={},n={};return e&&(n=JSON.parse(this.Base64.decode(e))),t.source=n.session_utm_source?n.session_utm_source:"",t.medium=n.session_utm_medium?n.session_utm_medium:"",t.term=n.session_utm_term?n.session_utm_term:"",t.content=n.session_utm_content?n.session_utm_content:"",t.campaign=n.session_utm_campaign?n.session_utm_campaign:"",t},s.parseUriOptions={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},s.parseUri=function(e){var t=this.parseUriOptions,n=t.parser[t.strictMode?"strict":"loose"].exec(e),r={},i=14;while(i--)r[t.key[i]]=n[i]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(e,n,i){n&&(r[t.q.name][n]=i)}),r},s.setAuth=function(e){this.auth=e},s.setLinkToken=function(e){this.linkToken=e},s.getUserId=function(){var e=this,t=null;return e.auth&&e.auth.userId&&(t=e.auth.userId),t},s.getUserBalance=function(){var e=this,t=-1;return e.auth&&e.auth.accountBalance&&(t=parseFloat(e.auth.accountBalance)),t},s.getAuthToken=function(){var e=this;return{uid:e.auth&&e.auth.userId?e.auth.userId:"",token:e.auth&&e.auth.token?e.auth.token:"",time:e.auth&&e.auth.time?e.auth.time:""}},s.getAuthTokenExternal=function(){var e=this,t={uid:e.auth&&e.auth.userId?e.auth.userId:"",token:e.auth&&e.auth.token?e.auth.token:"",time:e.auth&&e.auth.time?e.auth.time:""};return e.auth&&e.auth.deep&&(t.email=e.auth.email,t.clientId=e.cointentClientId,e.linkToken&&(t.linkToken=e.linkToken,t.publisher=e.auth.publisherId)),t},s.isAuthTokenUndefined=function(){return this.auth===undefined},s.insertInitStatus=function(e,r,i){var s=this,o=t("<iframe></iframe>"),u=t("#cointent_td").data(),a={publisher:e,ctClient:s.cointentClientId,ref:document.referrer,sutm:s.sessionUtmCookie,utm:s.articleUtmCookie,pd:s.publisherDataForServer};r&&(a.article=r,a.url=u&&u.articleUrl?u.articleUrl:document.URL,a.title=u&&u.articleTitle?u.articleTitle:""),o.attr({src:n.SITE_URI+"/initStatus?"+t.param(a),width:1,height:1,border:0,frameborder:0,style:"width:1px !important;height:1px !important;position:absolute;"}),s.emitter.once("initcomplete",function(){i.call(undefined)}),t("body").append(o)},s.loadMixpanel=function(){window.mixpanel||function(e,t){if(!t.__SV){var n,r,i,s;window.mixpanel=t,n=e.createElement("script"),n.type="text/javascript",n.async=!0,n.src=("https:"===e.location.protocol?"https:":"http:")+"//cdn.mxpnl.com/libs/mixpanel-2.2.min.js",r=e.getElementsByTagName("script")[0],r.parentNode.insertBefore(n,r),t._i=[],t.init=function(e,n,r){function o(e,t){var n=t.split(".");2==n.length&&(e=e[n[0]],t=n[1]),e[t]=function(){e.push([t].concat(Array.prototype.slice.call(arguments,0)))}}var u=t;"undefined"!=typeof r?u=t[r]=[]:r="mixpanel",u.people=u.people||[],u.toString=function(e){var t="mixpanel";return"mixpanel"!==r&&(t+="."+r),e||(t+=" (stub)"),t},u.people.toString=function(){return u.toString(1)+".people (stub)"},i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");for(s=0;s<i.length;s++)o(u,i[s]);t._i.push([e,n,r])},t.__SV=1.2}}(document,window.mixpanel||[]),window.mixpanel.init(n.MIXPANEL_TOKEN)},s.loadKeen=function(){var e=this;e.keenClient=new Keen({projectId:n.KEEN_PROJECTID,writeKey:n.KEEN_WRITEKEY})},s.loadJqueryCookie=function(e){(function(e){function t(e){return e=i.json?JSON.stringify(e):String(e),i.raw?e:encodeURIComponent(e)}function n(t,n){var s;if(i.raw)s=t;else e:{var o=t;0===o.indexOf('"')&&(o=o.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{o=decodeURIComponent(o.replace(r," ")),s=i.json?JSON.parse(o):o;break e}catch(u){}s=void 0}return e.isFunction(n)?n(s):s}var r=/\+/g,i=e.cookie=function(r,s,o){if(void 0!==s&&!e.isFunction(s)){o=e.extend({},i.defaults,o);if("number"==typeof o.expires){var u=o.expires,a=o.expires=new Date;a.setTime(+a+864e5*u)}return document.cookie=[i.raw?r:encodeURIComponent(r),"=",t(s),o.expires?"; expires="+o.expires.toUTCString():"",o.path?"; path="+o.path:"",o.domain?"; domain="+o.domain:"",o.secure?"; secure":""].join("")}o=r?void 0:{};for(var u=document.cookie?document.cookie.split("; "):[],a=0,l=u.length;a<l;a++){var c=u[a].split("="),h;h=c.shift(),h=i.raw?h:decodeURIComponent(h),c=c.join("=");if(r&&r===h){o=n(c,s);break}r||void 0===(c=n(c))||(o[h]=c)}return o};i.defaults={},e.removeCookie=function(t,n){return void 0===e.cookie(t)?!1:(e.cookie(t,"",e.extend({},n,{expires:-1})),!e.cookie(t))}})(e)},s.useLightbox=function(){return!this.isSafari()},s.isWindow=function(e){return typeof window.constructor=="undefined"?e instanceof window.constructor:typeof e!="undefined"&&e&&e.window===e},s.popupWindow=null,s.popupWindowInterval=null,s.windowPolling=function(){var e=this;e.isPopupActive()||(clearInterval(e.popupWindowInterval),e.emitter.emit("popupClose"))},s.isPopupActive=function(){var e=this,n=!1;return e.popupWindow&&e.popupWindow instanceof t?t("#"+e.popupWindow[0].id).length>0&&(n=!0):e.isWindow(e.popupWindow)&&(n=e.popupWindow.window!==undefined),n},s.openWindow=function(e,t,r){var i=this,s=500,o=400;if(this.useLightbox()===!1){var u=window.screenX+window.outerWidth/2-s/2,a=window.screenY+window.outerHeight/2-o/2;i.popupWindow=window.open(n.SITE_URI+"/"+e,"cointentPopupWindow","location=no, toolbar=no, directories=no, status=yes, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width="+s+", height="+o+", top="+a+", left="+u)}else{var f=this.openLightbox(n.SITE_URI+"/"+e,s,o,20,t);r&&f.addClass("active"),i.popupWindow=f}return i.popupWindowInterval=setInterval(function(){i.windowPolling()},1e3),i.popupWindow},s.openLightbox=function(e,n,r,i,s){var u=this,a=t("#cointent_lightbox"),f=s;if(a.length>0)return t("#cointent_lightbox iframe").attr({src:e}),t("#cointent_lightbox");var l=t('<div id="cointent_lightbox" ></div>'),c=t('<div class="cointent_modal"></div>').appendTo("body");t("<iframe></iframe>").attr({src:e,id:"cointent_popup_iframe",width:"100%",height:"100%",border:0,frameborder:0}).appendTo(l).load();var h=function(){l.remove(),c.remove()},p=function(e){if(u.isButtonDisabled(t(this)))return;u.disableButton(t(this)),u.emitter.emit("close"),f&&f(u),c.css({opacity:0}),l.css({opacity:0}),setTimeout(h,400),l.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",h)};return t('<div class="cointent_close"></div>').appendTo(l).on(o,p),t("body").append(l),u.isMobile()&&t("body").scrollTop(0),l},s.isButtonDisabled=function(e){return e.prop("disabled")===!0||e.prop("disabled")==="disabled"},s.disableButton=function(e){this.useLightbox()&&e.prop("disabled","disabled")},s.enableButton=function(e){this.useLightbox()&&e.removeProp("disabled")},s.apiCall=function(e,r,i,s){var o=this;t.ajax({type:e,url:window.location.protocol+n.API_BASE+r,data:i,success:function(e){e===""?e={error:"Empty response returned"}:(e=t.parseJSON(e),e||(e={error:"Invalid information returned"})),s.call(o,e)},error:function(e){console.error("ERROR",e),s.call(o,JSON.parse(e.responseText))}})},s.receiveMessage=function(e){var r=this,i=e.origin.split("://")[1],s=n.SITE_URI.split("://")[1];if(i!==s)return!1;var o;try{o=t.parseJSON(e.data)}catch(u){o=null}if(o===null)return;r.handleResponse(o)},s.loadJquery=function(){var e=this;t&&function(e){if(!e.support.cors&&e.ajaxTransport&&window.XDomainRequest){var t=/^https?:\/\//i,n=/^get|post$/i,r=new RegExp("^"+location.protocol,"i"),i=/text\/html/i,s=/\/json/i,o=/\/xml/i;e.ajaxTransport("* text html xml json",function(u,a,f){if(u.crossDomain&&u.async&&n.test(u.type)&&t.test(u.url)&&r.test(u.url)){var l=null,c=(a.dataType||"").toLowerCase();return{send:function(t,n){l=new XDomainRequest,/^\d+$/.test(a.timeout)&&(l.timeout=a.timeout),l.ontimeout=function(){n(500,"timeout")},l.onload=function(){var t="Content-Length: "+l.responseText.length+"\r\nContent-Type: "+l.contentType,r={code:200,message:"success"},u={text:l.responseText};try{if(c==="html"||i.test(l.contentType))u.html=l.responseText;else if(c==="json"||c!=="text"&&s.test(l.contentType))try{u.json=e.parseJSON(l.responseText)}catch(a){r.code=500,r.message="parseerror"}else if(c==="xml"||c!=="text"&&o.test(l.contentType)){var f=new ActiveXObject("Microsoft.XMLDOM");f.async=!1;try{f.loadXML(l.responseText)}catch(a){f=undefined}if(!f||!f.documentElement||f.getElementsByTagName("parsererror").length)throw r.code=500,r.message="parseerror","Invalid XML: "+l.responseText;u.xml=f}}catch(h){throw h}finally{n(r.code,r.message,u,t)}},l.onprogress=function(){},l.onerror=function(){n(500,"error",{text:l.responseText})};var r="";a.data&&(r=e.type(a.data)==="string"?a.data:e.param(a.data)),l.open(u.type,u.url),l.send(r)},abort:function(){l&&l.abort()}}}})}}(t),t.cookie||e.loadJqueryCookie(t)},s.s4=function(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)},s.guid=function(){return this.s4()+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+"-"+this.s4()+this.s4()+this.s4()},s.debuggerPrint=function(e){this.debugger&&console.log("CoinTent Ad Block | "+e)},s.activateDebugger=function(){this.debugger=!0},s.getLinkEmail=function(e){var n="";return e instanceof t&&e.data("link-email")?n=e.data("link-email"):e?n=e:typeof cointent_link!="undefined"&&cointent_link.email&&(n=cointent_link.email),n},s.getLinkToken=function(e){var n="";return e instanceof t&&e.data("link-token")?n=e.data("link-token"):e?n=e:typeof cointent_link!="undefined"&&cointent_link.token&&(n=cointent_link.token),n},s.cointentClientId=null,s.cointentClientCookieOptions={expires:3652,path:"/"},s.manageClientCookie=function(){var e=this;if(t){var n=t.cookie("cointent_client_id");n||(n=e.guid(),t.cookie("cointent_client_id",n,e.cointentClientCookieOptions)),e.cointentClientId=n}else console.warn("Notice: jQuery not loaded, cannot get CoinTent client id.")},s.sessionReferCookie=null,s.sessionReferCookieOptions={path:"/"},s.manageSessionReferCookie=function(){var e=this;if(t){t.cookie||e.loadJqueryCookie(t);var n=t.cookie("cointent_referrer");n===undefined&&(n=document.referrer?document.referrer:"",t.cookie("cointent_referrer",n,e.sessionReferCookieOptions)),e.sessionReferCookie=n}else console.warn("Notice: jQuery not loaded, cannot store session referrer.");e.addCommonTrackParams({session_refer:e.sessionReferCookie,article_refer:document.referrer,session_refer_domain:e.getHostFromUrl(e.sessionReferCookie),article_refer_domain:e.getHostFromUrl(document.referrer)}),e.manageUtmCookie()},s.getHostFromUrl=function(e){var t="";if(e){var n=document.createElement("a");n.href=e,t=n.hostname}return t},s.sessionUtmCookie=null,s.articleUtmCookie=null,s.utmCookieOptions={path:"/"},s.manageUtmCookie=function(){var e=this,n=e.getQueryParams(),r={},i={},s={},o="",u="";if(n.utm_source||n.utm_medium||n.utm_term||n.utm_content||n.utm_campaign)r.utm_source=n.utm_source?n.utm_source:"",r.utm_medium=n.utm_medium?n.utm_medium:"",r.utm_term=n.utm_term?n.utm_term:"",r.utm_content=n.utm_content?n.utm_content:"",r.utm_campaign=n.utm_campaign?n.utm_campaign:"",t.each(r,function(e,t){i["article_"+e]=t}),e.addCommonTrackParams(i),o=e.Base64.encode(JSON.stringify(i));u=t.cookie("cointent_utm"),u!==undefined?u&&(s=JSON.parse(e.Base64.decode(u))):(u="",t.each(r,function(e,t){s["session_"+e]=t}),t.isEmptyObject(s)||(u=e.Base64.encode(JSON.stringify(s))),t.cookie("cointent_utm",u,e.utmCookieOptions)),t.isEmptyObject(s)||e.addCommonTrackParams(s),e.sessionUtmCookie=u,e.articleUtmCookie=o},s.getQueryParams=function(){var e,t=/\+/g,n=/([^&=]+)=?([^&]*)/g,r=function(e){return decodeURIComponent(e.replace(t," "))},i=window.location.search.substring(1),s={};while(e=n.exec(i))s[r(e[1])]=r(e[2]);return s},s.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",n,r,i,o,u,a,f,l=0;e=s.Base64._utf8_encode(e);while(l<e.length)n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),o=n>>2,u=(n&3)<<4|r>>4,a=(r&15)<<2|i>>6,f=i&63,isNaN(r)?a=f=64:isNaN(i)&&(f=64),t=t+this._keyStr.charAt(o)+this._keyStr.charAt(u)+this._keyStr.charAt(a)+this._keyStr.charAt(f);return t},decode:function(e){var t="",n,r,i,o,u,a,f,l=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(l<e.length)o=this._keyStr.indexOf(e.charAt(l++)),u=this._keyStr.indexOf(e.charAt(l++)),a=this._keyStr.indexOf(e.charAt(l++)),f=this._keyStr.indexOf(e.charAt(l++)),n=o<<2|u>>4,r=(u&15)<<4|a>>2,i=(a&3)<<6|f,t+=String.fromCharCode(n),a!=64&&(t+=String.fromCharCode(r)),f!=64&&(t+=String.fromCharCode(i));return t=s.Base64._utf8_decode(t),t},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode:function(e){var t="",n=0,r=0,i=0,s=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(s=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|s&63),n+=2):(s=e.charCodeAt(n+1),i=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(s&63)<<6|i&63),n+=3);return t}},!function(e){function t(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function r(e,r,i,s,o,u){return t(n(t(t(r,e),t(s,u)),o),i)}function i(e,t,n,i,s,o,u){return r(t&n|~t&i,e,t,s,o,u)}function s(e,t,n,i,s,o,u){return r(t&i|n&~i,e,t,s,o,u)}function o(e,t,n,i,s,o,u){return r(t^n^i,e,t,s,o,u)}function u(e,t,n,i,s,o,u){return r(n^(t|~i),e,t,s,o,u)}function a(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var r,a,f,l,c,h=1732584193,p=-271733879,d=-1732584194,v=271733878;for(r=0;r<e.length;r+=16)a=h,f=p,l=d,c=v,h=i(h,p,d,v,e[r],7,-680876936),v=i(v,h,p,d,e[r+1],12,-389564586),d=i(d,v,h,p,e[r+2],17,606105819),p=i(p,d,v,h,e[r+3],22,-1044525330),h=i(h,p,d,v,e[r+4],7,-176418897),v=i(v,h,p,d,e[r+5],12,1200080426),d=i(d,v,h,p,e[r+6],17,-1473231341),p=i(p,d,v,h,e[r+7],22,-45705983),h=i(h,p,d,v,e[r+8],7,1770035416),v=i(v,h,p,d,e[r+9],12,-1958414417),d=i(d,v,h,p,e[r+10],17,-42063),p=i(p,d,v,h,e[r+11],22,-1990404162),h=i(h,p,d,v,e[r+12],7,1804603682),v=i(v,h,p,d,e[r+13],12,-40341101),d=i(d,v,h,p,e[r+14],17,-1502002290),p=i(p,d,v,h,e[r+15],22,1236535329),h=s(h,p,d,v,e[r+1],5,-165796510),v=s(v,h,p,d,e[r+6],9,-1069501632),d=s(d,v,h,p,e[r+11],14,643717713),p=s(p,d,v,h,e[r],20,-373897302),h=s(h,p,d,v,e[r+5],5,-701558691),v=s(v,h,p,d,e[r+10],9,38016083),d=s(d,v,h,p,e[r+15],14,-660478335),p=s(p,d,v,h,e[r+4],20,-405537848),h=s(h,p,d,v,e[r+9],5,568446438),v=s(v,h,p,d,e[r+14],9,-1019803690),d=s(d,v,h,p,e[r+3],14,-187363961),p=s(p,d,v,h,e[r+8],20,1163531501),h=s(h,p,d,v,e[r+13],5,-1444681467),v=s(v,h,p,d,e[r+2],9,-51403784),d=s(d,v,h,p,e[r+7],14,1735328473),p=s(p,d,v,h,e[r+12],20,-1926607734),h=o(h,p,d,v,e[r+5],4,-378558),v=o(v,h,p,d,e[r+8],11,-2022574463),d=o(d,v,h,p,e[r+11],16,1839030562),p=o(p,d,v,h,e[r+14],23,-35309556),h=o(h,p,d,v,e[r+1],4,-1530992060),v=o(v,h,p,d,e[r+4],11,1272893353),d=o(d,v,h,p,e[r+7],16,-155497632),p=o(p,d,v,h,e[r+10],23,-1094730640),h=o(h,p,d,v,e[r+13],4,681279174),v=o(v,h,p,d,e[r],11,-358537222),d=o(d,v,h,p,e[r+3],16,-722521979),p=o(p,d,v,h,e[r+6],23,76029189),h=o(h,p,d,v,e[r+9],4,-640364487),v=o(v,h,p,d,e[r+12],11,-421815835),d=o(d,v,h,p,e[r+15],16,530742520),p=o(p,d,v,h,e[r+2],23,-995338651),h=u(h,p,d,v,e[r],6,-198630844),v=u(v,h,p,d,e[r+7],10,1126891415),d=u(d,v,h,p,e[r+14],15,-1416354905),p=u(p,d,v,h,e[r+5],21,-57434055),h=u(h,p,d,v,e[r+12],6,1700485571),v=u(v,h,p,d,e[r+3],10,-1894986606),d=u(d,v,h,p,e[r+10],15,-1051523),p=u(p,d,v,h,e[r+1],21,-2054922799),h=u(h,p,d,v,e[r+8],6,1873313359),v=u(v,h,p,d,e[r+15],10,-30611744),d=u(d,v,h,p,e[r+6],15,-1560198380),p=u(p,d,v,h,e[r+13],21,1309151649),h=u(h,p,d,v,e[r+4],6,-145523070),v=u(v,h,p,d,e[r+11],10,-1120210379),d=u(d,v,h,p,e[r+2],15,718787259),p=u(p,d,v,h,e[r+9],21,-343485551),h=t(h,a),p=t(p,f),d=t(d,l),v=t(v,c);return[h,p,d,v]}function f(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function c(e){return f(a(l(e),8*e.length))}function h(e,t){var n,r,i=l(e),s=[],o=[];for(s[15]=o[15]=void 0,i.length>16&&(i=a(i,8*e.length)),n=0;16>n;n+=1)s[n]=909522486^i[n],o[n]=1549556828^i[n];return r=a(s.concat(l(t)),512+8*t.length),f(a(o.concat(r),640))}function p(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function d(e){return unescape(encodeURIComponent(e))}function v(e){return c(d(e))}function m(e){return p(v(e))}function g(e,t){return h(d(e),d(t))}function y(e,t){return p(g(e,t))}function b(e,t,n){return t?n?g(t,e):y(t,e):n?v(e):m(e)}e.md5=b}(s),s.isAdBlocked=function(e){var t=this;i.onDetected(function(){navigator.userAgent.toLowerCase().indexOf("firefox")>-1?(i.clearEvent(),setTimeout(function(){t.secondCheck(e)},1)):e.call(undefined,!0)}).onNotDetected(function(){e.call(undefined,!1)}),i.check()},s.secondCheck=function(e){i.onDetected(function(){e.call(undefined,!0)}).onNotDetected(function(){e.call(undefined,!1)}),i.check()},s.isAdBlockedPublisher=function(e,t,n){var r=this;e=parseInt(e),r.isAdBlocked(function(i){var s=i?1:0;r.apiCall("get","/ab/publisher/"+e+"/"+s,null,function(e){e.status?e.status=="success"?t.call(undefined,i):n&&n.call(undefined,i):console.warn("cointent.isAdBlocked(): Error occurred while initializing ad block detection! Callback will not fire.")})})},s.experimentVariants={},s.addExperimentVariants=function(e){var n=this;t.extend(n.experimentVariants,e)},s.getVariant=function(e,t,n){var r=0;return this.experimentVariants&&this.experimentVariants.exp[e]?e==="global"&&this.experimentVariants.exp[e][t]?r=this.experimentVariants.exp[e][t]:e=="publisher"&&this.experimentVariants.exp[e][n]&&this.experimentVariants.exp[e][n][t]?r=this.experimentVariants.exp[e][n][t]:console.warn("Cannot get variant for "+t+" of type "+e+" publisher id: "+n):console.warn("Cannot get variant for "+t+" of type "+e),r},s.commonTrackParams={},s.addCommonTrackParams=function(e){var n=this;t.extend(n.commonTrackParams,e)},s.flattenData=function(e){var n=this,r={};return e&&t.each(e,function(e,i){typeof i=="object"?r=t.extend(n.flattenWithPrefix(e,i),r):r[e]=i}),r},s.flattenWithPrefix=function(e,n){var r=this,i={};return n&&t.each(n,function(n,s){typeof s=="object"?i=t.extend(r.flattenWithPrefix(e+"_"+n,s),i):i[e+"_"+n]=s}),i},s.track=function(e,n){var r=this,i=t.extend({},r.experimentVariants,r.commonTrackParams,n),s="/t/"+e;r.apiCall("POST",s,i,function(){})},s.storage={prefix:"cointent_",hasStorage:function(){var e=this.prefix+"test";try{return localStorage.setItem(e,"1"),localStorage.removeItem(e),!0}catch(t){return!1}},setItem:function(e,n){this.hasStorage()?localStorage.setItem(this.prefix+e,n):n===null||n===""||n===0?t.removeCookie(this.prefix+e):t.cookie(this.prefix+e,n,{expires:3652})},getItem:function(e){return this.hasStorage()?localStorage.getItem(this.prefix+e):t.cookie(this.prefix+e)}},s.publisherDataForServer=null,s.addPublisherData=function(){var e=this;if(typeof cointent_tracking_data!="undefined"&&cointent_tracking_data.publisherData){var t;JSON&&JSON.stringify?t=JSON.stringify(cointent_tracking_data.publisherData):t=String(cointent_tracking_data.publisherData);if(t.length>1200){console.error("publisherData is too long; ignoring.");return}e.addCommonTrackParams({publisher_data:cointent_tracking_data.publisherData}),e.publisherDataForServer=t}},s.getGating=function(e,t,n,r){var i=this.getAuthToken(),s=this;if(this.isAuthTokenUndefined())this.insertInitStatus(e,t,function(){s.getGating(e,t,n,r)});else if(i.token){var o="/gating/publisher/"+e+"/article/"+t;this.apiCall("GET",o,i,function(i){var o=i;i&&i.gating&&(o=i.gating);if(r){i.authResponse&&s.setAuth(i.authResponse);var u=!!i.gating.access;s.emitter.emit("accessChange",e,t,u,i)}n.call(this,o)})}else r&&s.emitter.emit("accessChange",e,t,!1,{gating:{access:!1}}),n.call(s,{access:!1})},s.start=function(){this.loadJquery(this)},s}),ctRequire.define("widget/response",["jquery","utils/utils"],function(e,t){var n={},r=[];n.RELOAD_PARTIAL=0,n.RELOAD_IN_PLACE=1,n.RELOAD_FULL_REFRESH=2,Date.now=Date.now||function(){return+(new Date)},n.loadingCount=0,n.waitingToLoad=!1;var i=function(e,n,i){return e.lockClientOnly(n),r[n]&&(t.storage.setItem("loadedFull_"+n,0),r[n]=!1,a(e,n,{},!1)),!1},s=function(n,i,s){if(!n.currentlyReloading&&parseInt(t.storage.getItem("loadedFull_"+i),10)>0){r[i]=!0;var o=Date.now();t.track("perf",{time:o-parseInt(t.storage.getItem("loadedFull_"+i),10),type:"unlocking"}),t.storage.setItem("loadedFull_"+i,0)}r[i]||(e.event.trigger("articleReloadedCB",[i]),r[i]=!0,n.clientOnly?n.lockClientOnly(i):a(n,i,s))},o=function(e){return(e||document.location.search).replace(/(^\?)/,"").split("&").map(function(e){return e=e.split("="),this[e[0]]=e[1],this}.bind({}))[0]},u=function(n,r,i,s){var u=o(window.location.search),a,f=e('<form method="post" action="" id="ct_full_reload_form" ></form>',{action:"",method:"post"});e("body").append(f);if(!u.fullReload){i.fullReload=!0,t.emitter.emit("startArticleReload",[r]);if(i.token&&i.uid&&i.time){t.storage.setItem("loadedFull_"+r,s);for(a in i)i.hasOwnProperty(a)&&f.append('<input type="hidden" value="'+i[a]+'" name="'+a+'"/>')}n.currentlyReloading||(n.currentlyReloading=!0,f.append('<button type="submit"></button>'),f.trigger("submit"))}else t.emitter.emit("articleReloaded",[r])},a=function(r,i,s){var o="locking",a=Date.now();s.token&&(o="unlocking"),r.fullRefresh==1||r.reloadType===n.RELOAD_FULL_REFRESH?u(r,i,s,a):(s.loadScript=!0,t.emitter.emit("startArticleReload",[i]),e.ajax({type:"GET",data:s,dataType:"html",success:function(e,n,s){var u=Date.now();t.track("perf",{time:u-a,type:o}),t.emitter.emit("articleReloaded",[i]),f(r,e,n,s,i,o)},error:function(e,t,n){return!1}}))},f=function(n,r,i,s,o,u){var a,f=0,l=Date.now(),c=null,h=e(r).find("#post-"+o),p=e("body, html").find(".cointent-widget");if(n.reloadType!==1&&n.reloadType!==2||u!=="unlocking"){for(f=0;f<p.length;f++){c=e(p[f]).data("article-id");if("post-"+c===h.attr("id")){a=e(p[f]).parent().find(".cointent");break}}a&&h.find(".cointent-widget").after(a),h.find(".cointent-widget").after(e("body, html").find("#cointent_action_iframe")),h.find(".premessaging").remove(),e("body, html").find("#"+h.attr("id")).replaceWith(h),u==="unlocking"&&n.unlockClientOnly(o),t.track("perf",{time:Date.now()-l,type:"updating_article"})}else{document.open(),document.write(r),document.close(),n.loadingCount=0;var d=function(){var e=document.getElementsByClassName("cointent-widget");if(!(e&&e.length>0)){n.loadingCount++,n.loadingCount<1e3&&setTimeout(d,1e3);return}n.unlockClientOnly(),n.waitingToLoad=!1,u==="unlocking"&&window.cointent.buildWidget(),t.track("perf",{time:Date.now()-l,type:"updating_article"})};n.waitingToLoad===!1&&(n.waitingToLoad=!0,e(document).ready(d))}};return n.lockClientOnly=function(t){var n=this.getLockedElement(t),r=n.hasClass("active");if(r){var i=n.css("height");n.css({"webkit-transition":"",transition:""}).css({"max-height":i}).css({"webkit-transition":"max-height 4s linear",transition:"max-height 4s linear"})}n.css({"max-height":"0"}),n.removeClass("active"),n.attr("hidden","hidden"),e("#cointent_preview_"+t).removeClass("inactive")},n.unlockClientOnly=function(t){var n=this.getLockedElement(t);n.removeAttr("hidden"),n.addClass("active").css("max-height",""),e("#cointent_preview_"+t).addClass("inactive")},n.getLockedElement=function(t){var n=["#post-"+t,".postid-"+t],r=e(document);for(var i=0;i<n.length;i++){var s=e(document).find(n[i]);t&&s.length>0&&(r=s);var o=r.find(".cointent_gated"),u=null;for(var a=0;a<o.length;a++)e(o[a]).text().trim()!==""&&e(o[a]).prop("id")==="cointent_gated_"+t&&(u?e.contains(o[a],u)&&(u=e(o[a])):u=e(o[a]));if(!u||u.length<=0)u=r.find("#cointent_gated");if(u.length)break}return u},n.gatingCallback=function(e,n,r){var o=this;e?(o.clientOnly||i(o,n,r),t.storage.setItem("loadedFull_"+n,0),o.lockClientOnly(n)):(o.clientOnly||s(o,n,r),o.unlockClientOnly(n))},n.onLogout=function(){var t=e(".cointent-widget");for(var n=0;n<t.length;n++){var r=e(t[n]).data("article-id");this.gatingCallback(!0,r,{})}},n.init=function(){var e=this;t.emitter.on("logout",function(){e.onLogout()}),t.emitter.on("accessChange",function(n,r,i,s,o,u,a){if(u!==undefined||u!==null)e.fullRefresh=u;if(o!==undefined||o!==null)e.reloadType=o;e.clientOnly=a,e.gatingCallback(!i,r,t.getAuthToken())})},n.init(),n}),ctRequire.define("widget/model_button",["jquery","utils/utils","config/config"],function(e,t,n){return function(){this.elem=null,this.state={conversionElem:null,accessType:"",component:"widget",publisher:0,article:0,expiry:0,flat:!1,branding:"messaging",currency:{publisher:"",user:""},convertedPrice:"",price:"",status:"active",subscription:!1,size:"",upgradeSubs:!1,type:0,visible:"hidden",working:!1,invalid:!1,shownSubscriptions:null},this.props={verbs:{subscription:"",buy:""}},this.init=function(e){for(var t in e)this.state[t]!==undefined&&(this.state[t]=e[t]),this.props.hasOwnProperty(t)&&(this.props[t]=e[t])},this.update=function(e){for(var t in e)if(e.hasOwnProperty(t)){this.state.hasOwnProperty(t)&&(this.state[t]=e[t]);if(this.props.hasOwnProperty(t))if(typeof this.props[t]=="object")for(var n in this.props[t])this.props[t].hasOwnProperty(n)&&!this.props[t].subP&&(this.props[t][n]=e[t][n]);else this.props[t]||(this.props[t]=e[t])}this.render(this.elem)},this.subscribeCallback=function(e,n){e.preventDefault();var r=[];n.state.showSubscriptions&&n.state.showSubscriptions.length>0&&(r=n.state.showSubscriptions),t.emitter.emit("subscribeClick",e,n.state.subscription===!0&&!n.state.upgradeSubs,r)},this.upgradeSubCallback=function(e){e.preventDefault(),t.emitter.emit("upgradeSubBtnClick",e)},this.checkoutCallback=function(n){var r=e(n.delegateTarget),i=r.closest(".cointent").siblings(".cointent-widget,.cointent-video");i.length<=0&&(i=e(".cointent-gumshoe,.cointent-edgeworth"));var s=this.state;if(s.invalid)return;n.preventDefault();if(t.isButtonDisabled(r))return;return t.emitter.emit("focus"),t.emitter.emit("checkoutClick"),t.emitter.emit("unlock",!1,i),t.track("click",{component:s.component,page:"buy_button",url:window.location.href,publisher:s.publisher,article:s.article,price:s.price,balance:t.getUserBalance(),user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),!1},this.render=function(){var r=i(this.state),o=this.state.subscription?"_sub":"",u=this.state.visible==="visible"?"":'style="display:none;"',a=e('<button id="cointent_button_'+this.state.publisher+"_"+this.state.article+o+'" class="'+r+'" '+u+"></button>"),f=e('<span class="confirm_buttontext"></span>').appendTo(a),l="";this.state.price&&!this.state.subscription&&(l=t.formatCostForButton(this.state.price,this.state.currency.publisher));var c="spinner ";this.state.working?c+="on":c+="off",f.append('<div class="button_overlay"></div><div class="'+c+'" ></div>');var h=null;this.showConversion()&&(h=e('<p class="converted_price">about '+t.getCurrencySymbol(this.state.currency.user)+this.state.convertedPrice.toFixed(2)+" "+this.state.currency.user+"</p>")),f.prepend('<span class="button_text">'+this.getText()+'</span><span class="cointent-cost">'+l+"</span>"),this.state.branding==="button"&&f.prepend('<img class="button_icon" src="'+n.CONNECT_BASE+'/images/white_icon.png"/>'),this.elem&&this.state.status=="deleted"&&(delete this.state.visible,this.elem.remove()),this.state.status!=="active"?(a.find(".cointent-cost").hide(),t.disableButton(a)):t.enableButton(a),s(a,this);if(this.elem){if(h){var p=e('<div class="cointent_button_wrapper"></div>').append(a).append(h);a=p}this.elem.replaceWith(a)}this.elem=a;switch(this.state.visible){case"fade_in":a.delay(600).show(),a.fadeIn(),this.state.visible="visible";break;case"hidden":a.hide();break;case"visible":a.show()}return a},this.showConversion=function(){var e=!1;return this.state.currency.user&&this.state.currency.publisher&&this.state.status=="active"&&this.state.currency.user!==this.state.currency.publisher&&!this.state.subscription&&this.state.convertedPrice>0&&(e=!0),e},this.getText=function(){return this.state.status=="active"?u(this.state,this.props):o(this.state,this.props)};var i=function(e){var t="ct-button";return e.subscription===!0?e.upgradeSubs?t+=" cointent-upgradesub-button":t+=" cointent-subscribe-button manage_subscription":t+=" cointent-checkout-button",e.status==="active"?(e.subscription===!0&&(t+=" secondary"),e.branding==="button"&&(t+=" icon")):e.status=="invalid"?t+=" invalid":t+=" purchased",e.working&&(t+=" on"),e.flat&&(t+=" flat"),e.size&&(t+=" "+e.size),t},s=function(e,t){t.state.subscription===!0?t.state.upgradeSubs?e.click(t.upgradeSubCallback):e.click(function(e){t.subscribeCallback(e,t)}):e.click(function(e){t.checkoutCallback(e)})},o=function(e,t){var n="Purchased";switch(e.accessType){case"single":break;case"weekly":case"monthly":case"yearly":n="Subscribed";break;case"daily":n="Daily Pass";break;case"freeAccess":n="Access Granted";break;default:n=e.accessType}return t.verbs.buy==="Donate"&&(n="Thank You"),n},u=function(e,t){var n=t.verbs.buy?t.verbs.buy:"Read";return e.subscription?e.upgradeSubs?t.verbs.subscription?n="Upgrade "+t.verbs.subscription:n="Upgrade Subscription":t.verbs.subscription?n=t.verbs.subscription+" Options":n="Subscription Options":(e.expiry!==0?e.expiry===1?n="Day Pass":n=e.expiry+"-Day Pass":e.type===1&&(n="Watch"),n!=="Donate"&&(n+=" for"),n=n[0].toUpperCase()+n.slice(1),n+="&nbsp",e.price===0&&(n="Access for Free")),n}}}),ctRequire.define("widget/collection_button",["widget/model_button","utils/utils","jquery"],function(e,t,n){var r={},i={};return r.createButton=function(t){var n=new e;return n.init(t),i[t.publisher]||(i[t.publisher]=[]),i[t.publisher][t.article]||(i[t.publisher][t.article]=[]),i[t.publisher][t.article].push(n),n.render()},r.updateButton=function(e,n,r){if(!i[e]||!i[e][n])return!1;for(var s in i[e][n])i[e][n].hasOwnProperty(s)&&i[e][n][s].update(r);return t.emitter.emit("updateButton"),!0},r.updateByType=function(e,n,r,s){if(i[e]&&i[e][n]){var o=i[e][n];for(var u in o){if(!o.hasOwnProperty(u))continue;var a=o[u],f=!0;for(var l in r){if(!r.hasOwnProperty(l))continue;if(a.state[l]!==r[l]){f=!1;break}}f&&a.update(s)}}return t.emitter.emit("updateButton"),!0},r.doesButtonExist=function(e,t,n){if(i[e]&&i[e][t]){var r=i[e][t];for(var s in r){if(!r.hasOwnProperty(s))continue;var o=r[s],u=!0;for(var a in n){if(!n.hasOwnProperty(a))continue;if(o.state[a]!==n[a]){u=!1;break}}if(u)return!0}}return!1},r.updateAll=function(){return!1},r}),ctRequire.define("widget/model_messaging",["jquery","utils/utils","config/config"],function(e,t,n){return function(){this.state={accessType:"",accountBalance:0,currency:{user:"",publisher:""},convertedBalance:0,article:0,component:"widget",email:"",linkToken:"",publisher:0,branding:"messaging",status:"loggedout",visible:"hidden"},this.props={verbs:{subscription:null,buy:null}},this.init=function(e){for(var t in e)this.state[t]!==undefined&&(this.state[t]=e[t]),this.props.hasOwnProperty(t)&&(this.props[t]=e[t])},this.update=function(t){var n;for(var r in t)if(t.hasOwnProperty(r)){if(this.state.hasOwnProperty(r))if(typeof this.state[r]=="object")for(n in this.state[r])this.state[r].hasOwnProperty(n)&&!this.state[r][n]&&(this.state[r][n]=t[r][n]);else this.state[r]=t[r];if(this.props.hasOwnProperty(r))if(typeof this.props[r]=="object")for(n in this.props[r])this.props[r].hasOwnProperty(n)&&!this.props[r][n]&&(this.props[r][n]=t[r][n]);else this.props[r]||(this.props[r]=t[r])}var i=e("#cointent_messaging_"+this.state.publisher+"_"+this.state.article).addClass("cointent_messaging");i.length<=0&&(i=null),this.render(i)},this.render=function(r){var i=this,s="cointent_logo",o="logout_messaging",u="login_messaging";this.state.status==="loggedin"?o+=" on":(s+=" on",u+=" on");var a=e('<div class="'+o+'"></div>'),f=this.state.accessType,l="",c=e('<div id="cointent_messaging_'+this.state.publisher+"_"+this.state.article+'"  class="cointent_messaging"></div>');this.state.branding==="messaging"&&e('<a class="'+s+'" target="_blank" href="'+n.SITE_URI+'"><img class="powered_by_logo_widget_login" src="'+n.CONNECT_BASE+'/images/base64/powered_by_logo_widget_login.png" alt="Powered by CoinTent "/></a>').appendTo(c).bind("click",function(e){i.logoClickTrack(e,i)});var h=e('<div class="'+u+'"><span>Existing Account?</span></div>').appendTo(c);e('<a class="cointent_login">Log In</a>').appendTo(h).bind("click",function(e){i.loginCallback(e,i)});if(this.state.email){var p=e("<span>"+t.formatEmailForDisplay(this.state.email)+"</span>"),d=e('<a class="cointent_logout">(Log out)</a>').bind("click",this.logoutCallback),v=e('<br/><div class="cointent_logo_grey_small"></div>');this.state.linkToken&&d.css("display","none"),f=="weekly"||f=="monthly"||f=="yearly"?l=e('<a class="manage_subscription">Manage '+this.props.verbs.subscription+"</a>").bind("click",function(e){i.manageSubscriptions(e)}):l=e("<span>balance: "+t.getCurrencySymbol(this.state.currency.user)+this.state.accountBalance.toFixed(2)+" </span>")}return this.state.status==="loggedin"&&a.append(p,d,v,l).appendTo(c),r&&r.replaceWith(c),c},this.loginCallback=function(n,r){n.preventDefault();var i=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-video");return i.length<=0&&(i=e(".cointent-gumshoe,.cointent-edgeworth")),t.emitter.emit("loginclick",i.data("publisher-id"),i.data("article-id")),t.track("click",{component:r.state.component,page:"log_in",url:window.location.href,publisher:i.data("publisher-id"),article:i.data("article-id"),price:i.data("price"),balance:t.getUserBalance(),user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),!1},this.logoutCallback=function(n){n.preventDefault();var r=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-video");if(typeof r.data("invalid")!="undefined")return;if(t.isButtonDisabled(e(this)))return;return t.disableButton(e(this)),t.emitter.emit("logoutclick"),!1},this.logoClickTrack=function(n,r){var i=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-video");i.length<=0&&(i=e(".cointent-gumshoe,.cointent-edgeworth")),t.track("click",{component:r.state.component,page:"logo",url:window.location.href,publisher:i.data("publisher-id"),article:i.data("article-id"),price:i.data("price"),user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe})},this.manageSubscriptions=function(n){n.preventDefault();var r=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-video");t.emitter.emit("manageclick",r)}}}),ctRequire.define("widget/collection_messaging",["widget/model_messaging","utils/utils","jquery"],function(e,t,n){var r={},i={};return r.create=function(t){var n=new e;return n.init(t),i[t.publisher]||(i[t.publisher]=[]),i[t.publisher][t.article]=n,n.render()},r.render=function(e,t){return i[e][t].render()},r.update=function(e,n,r){return!i[e]||!i[e][n]?!1:(i[e][n].update(r),t.emitter.emit("updateMessaging"),!0)},r.updateAll=function(e){var t=null,n=null;for(t in i)if(i.hasOwnProperty(t))for(n in i[t])i[t].hasOwnProperty(n)&&i[t][n].update(e);return!1},r}),ctRequire.define("widget/model_widget",["jquery","utils/utils","config/config","widget/collection_button","widget/collection_messaging"],function(e,t,n,r,i){return function(o){this.widget=o,this.state={element:null,publisher:{id:null,currency:null},user:{accountBalance:0,userCurrency:"",conversionRate:1},additionalCss:null,article:{url:null,id:null,title:null,labels:null,price:null},linkEmail:null,linkToken:null,buttons:{buy:!0,subscription:!1},showSubscription:[],invalid:null,ui:{flat:!0,title:null,postPurchaseTitle:null,subtitle:null,image_url:null,viewType:null,compactView:null},verbs:{subscription:null,buy:null}},this.init=function(e){var n=this;this.update(e),this.state.article.id||console.error("Error: please provide article id"),this.state.publisher.id||console.error("Error: please provide publisher id"),t.emitter.on("updateWidget",function(e){n.update(e)})},this.update=function(e){var t=null,n=!1;if(e.publisherId&&this.state.publisher.id!==null&&e.publisherId!==this.state.publisher.id){console.warn("Updating a different publisher");return}if(e.articleId&&this.state.article.id!==null&&e.articleId.toString()!==this.state.article.id.toString()){console.warn("Updating a different article");return}for(var r in e){if(!e.hasOwnProperty(r))continue;t=e[r];if(r.lastIndexOf("article",0)!==-1)r=r.split("article")[1].toLowerCase(),this.state.article[r]!==undefined&&this.state.article[r]!==t&&(this.state.article[r]=t,n=!0);else if(r.lastIndexOf("publisher",0)!==-1)r=r.split("publisher")[1].toLowerCase(),this.state.publisher[r]!==undefined&&this.state.publisher[r]!==t&&(this.state.publisher[r]=t,n=!0);else if(r.indexOf("Verb",r.length-4)!==-1)r=r.split("Verb")[0].toLowerCase(),this.state.verbs[r]!==undefined&&this.state.verbs[r]!==t&&(this.state.verbs[r]=t,n=!0);else if(this.state.ui[r]!==undefined){if(r==="viewType"){var i=t.split(" ");i.indexOf("full")==-1&&i.indexOf("condensed")==-1&&(t+=" full"),i.indexOf("buyButtonOff")>-1&&this.state.button!==!1&&(this.state.button=!1,n=!0)}this.state.ui[r]!==t&&(this.state.ui[r]=t,n=!0)}else this.state.user[r]!==undefined&&this.state.user[r]!==t?(this.state.user[r]=t,n=!0):this.state[r]!==undefined&&this.state[r]!==t&&(this.state[r]=t,n=!0)}n===!0&&this.renderUpdate()},this.render=function(){var r=t.isIE8()?"ie8":"",i=e('<div id="cointent_'+this.state.publisher.id+"_"+this.state.article.id+'" class="cointent '+this.state.ui.viewType+" "+r+" "+this.state.additionalCss+'"></div>'),s=e('<div class="publisher_info"></div>'),o=e('<div class="buy_widget ct_mobile"></div>'),u=e('<div class="cointent_banner '+this.state.ui.viewType+'"></div>');this.setupPublisherInfo(s),this.setupBuyWidget(o),u.append(s,o).appendTo(i);if(!this.state.element){var a=e("<iframe></iframe>"),f=t.getLinkEmail(this.state.linkEmail),l=t.getLinkToken(this.state.linkToken),c={publisher:this.state.publisher.id,article:this.state.article.id,url:this.state.article.url?this.state.article.url:document.URL,title:this.state.article.title,labels:this.state.article.labels,price:this.state.article.price,lemail:f,ltoken:l,ctClient:t.cointentClientId,ref:document.referrer,sutm:t.sessionUtmCookie,utm:t.articleUtmCookie,pd:t.publisherDataForServer};a.attr({src:n.SITE_URI+"/initStatus?"+e.param(c),id:"cointent_action_iframe",width:1,height:1,border:0,frameborder:0,style:"width:1px !important;height:1px !important; display:block !important;"}).insertAfter(this.widget)}else this.state.element.replaceWith(i);return this.state.element=i,i},this.checkUIFormat=function(){var t=e(".cointent_button_ctn").width();if(t>600){this.state.ui.compactView=!1,e(".cointent_button_ctn").removeClass("compact");return}var n=e(".cointent_button_ctn").children(),r=0;for(var i=0;i<n.length;i++)e(n[i]).is(":visible")&&(r+=e(n[i]).width());t<r?(this.state.ui.compactView=!0,e(".cointent_button_ctn:not([class*='compact'])").addClass("compact")):(this.state.ui.compactView=!1,e(".cointent_button_ctn").removeClass("compact"))},this.renderUpdate=function(){var e={price:this.state.article.price,verbs:this.state.verbs,currency:{publisher:this.state.publisher.currency,user:this.state.user.userCurrency},convertedPrice:this.state.user.conversionRate*this.state.article.price};this.state.user.conversionRate>0&&this.state.article.price>0&&(e.convertedPrice=this.state.user.conversionRate*this.state.article.price),i.update(this.state.publisher.id,this.state.article.id,e),r.updateButton(this.state.publisher.id,this.state.article.id,e)},this.setupPublisherInfo=function(t){t.append('<p class="cointent_title">'+this.state.ui.title+"</p>");var n=e('<div class="cointent_title_text"></div>').appendTo(t),r=e('<div class="cointent_subtitle">'+this.state.ui.subtitle+"</div>").appendTo(n);this.state.ui.image_url?n.prepend('<img src="'+this.state.ui.image_url+'"/>').append('<div style="clear:both"></div>'):r.css("max-width","none"),!this.state.ui.title&&!this.state.ui.subtitle&&t.hide()},this.setupBuyWidget=function(t){e('<div class="vertical_align"></div>').appendTo(t);var n=this.state.ui.compactView?"compact":"",s=e('<div class="cointent_button_ctn '+n+'"></div>').appendTo(t),o={invalid:this.state.invalid,publisher:this.state.publisher.id,article:this.state.article.id,articleTitle:this.state.article.title,flat:this.state.ui.flat,currency:{publisher:this.state.publisher.currency,user:this.state.user.userCurrency},verbs:this.state.verbs},u=r.createButton(o);o.subscription=!0,o.shownSubscriptions=this.state.shownSubscriptions;var a=r.createButton(o);s.append(a),s.append('<div class="cointent-or" style="display: none;">OR</div>'),s.append(u);var f=i.create({publisher:this.state.publisher.id,article:this.state.article.id});s.append(f)},this.getElement=function(){return this.state.element}}}),ctRequire.define("widget/widget",["jquery","utils/utils","config/config","widget/model_widget","widget/collection_button","widget/collection_messaging"],function(e,t,n,r,i,s){var o={},u="click";return o.publisherId=null,o.widgetCache={},o.collection_widgets={},o.expiryCache={},o.widgetViewSettingsClient={},o.widgetViewSettingsServer={},o.init=function(){var e=this;t.emitter.on("updateWidget",function(t){e.updateWidget(t)}),t.emitter.on("logout",function(){e.onLogout()}),t.emitter.on("login",function(t){e.onLogin(t)}),t.emitter.on("updateButton",function(){e.bindButtons()}),t.emitter.on("startArticleReload",function(t){i.updateButton(e.publisherId,t,{working:!0})}),t.emitter.on("articleReloaded",function(t){s.update(e.publisherId,t),i.updateButton(e.publisherId,t,{working:!1})}),t.emitter.on("subscribeClick",function(t,n,r){e.subscribeCallback(t,n,r)}),t.emitter.on("upgradeSubBtnClick",function(t){e.upgradeSubCallback(t)}),t.emitter.on("accessChange",function(n,r,i,s){var o=e.widgetCache[n+"-"+r];if(o){var u=s.gating?s.gating.type:"";e.resetPublisherInfo(o,!i,u),e.updateButton(o,!i,u,s),e.updateSubscriptionOptionsButton(o,!i,s.gating?s.gating:null);var a=s.status==="active"?!0:!1;a=t.auth!==null?!0:a,e.updateLoggedInMessaging(a)}}),t.emitter.on("invalidateWidget",function(t){e.invalidateWidget(t)})},o.onArticleReload=function(t,n){var r=this;e("#cointent_"+this.publisherId+"_"+n+" .cointent-checkout-button"),r.bindEvents()},o.setWidgetModel=function(e,t,n,r){this.collection_widgets[e]===undefined&&(this.collection_widgets[e]=[]);if(this.collection_widgets[e][t]!==undefined){console.warn("Widget for article "+t+" has already been initialized");return}return n.init(r),this.collection_widgets[e][t]=n,n},o.buildWidget=function(n){var i=this,s=n.data("publisher-id"),o=n.data("article-id"),u=this.setWidgetModel(s,o,new r(n),n.data());if(u){var a=u.render();a.insertAfter(n),i.widgetCache[s+"-"+o]=a}var f=n.data("view-type")?n.data("view-type"):"",l=f.split(" ");l.indexOf("full")==-1&&l.indexOf("condensed")==-1&&(f+=" full",l.push("full")),l.indexOf("buyButtonOn")>-1?i.widgetViewSettingsClient[s+"-"+o]={buyButton:"on"}:l.indexOf("buyButtonOff")>-1&&(i.widgetViewSettingsClient[s+"-"+o]={buyButton:"off"}),n.siblings(".premessaging").length?n.siblings(".premessaging").remove():e(".premessaging_"+s+"_"+o).length&&e(".premessaging_"+s+"_"+o).remove(),t.isAdBlocked(function(e){t.track("view",{component:"widget",page:"client_loaded",adblock:e?1:0,publisher:s,article:o,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe,tti:Date.now()-window.cointent_startTime})})},o.bindEvents=function(){var n=this,r=function(r){r.preventDefault();var i=e(r.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(n.isInvalid(i))return;if(t.isButtonDisabled(e(this)))return;return t.disableButton(e(this)),t.emitter.emit("loginclick",i.data("publisher-id"),i.data("article-id")),t.track("click",{component:"widget",page:"log_in",publisher:i.data("publisher-id"),article:i.data("article-id"),price:i.data("price"),balance:t.getUserBalance(),user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),!1};n.bindButtons(),e(".videoLoginTab").find(".login").off(u).on(u,r)},o.bindButtons=function(){var n=this,r=function(r){r.preventDefault();var i=e(r.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(n.isInvalid(i))return;return t.emitter.emit("checkoutClick"),n.onCheckout(r,n,"unlock"),!1};e(".videoLoginTab").find(".cointent-checkout-button").off(u,r).on(u,r)},o.resetPublisherInfo=function(e,t){var n=e.siblings(".cointent-widget,.cointent-edgeworth,.cointent-video"),r=e.find(".cointent_title"),i=e.find(".cointent_subtitle");if(!t){var s=n.data("post-purchase-title"),o=n.data("post-purchase-subtitle");r&&s?r.html(s):r.html(""),i&&o?i.html(o):i.html(""),(s||o)&&e.find(".publisher_info").css("display","block")}else{var u=n.data("title"),a=n.data("subtitle");r&&u?r.html(u):r.html(""),i&&a?i.html(a):i.html(""),!u&&!a&&e.find(".publisher_info").hide()}},o.updateSubscriptionOptionsButton=function(e,t,n){var r=this,s=e.siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(r.isInvalid(s))return;var o=s.data("publisher-id"),u=s.data("article-id"),a="visible";if(!t){i.updateByType(o,u,{subscription:!0},{visible:"hidden"}),e.find(".cointent-or").removeClass("on");return}r.isBuyButtonOn(o,u)&&e.find(".cointent-or").css("display","").addClass("on"),i.updateByType(o,u,{subscription:!0},{visible:"visible"}),n&&n.activeSubs.length>0&&n.access===!1?(n.billingStopped.length>0&&(a="hidden"),i.updateByType(o,u,{subscription:!0},{visible:a,upgradeSubs:!0}),n.billingStopped.length>0&&e.find(".cointent-or").css("display","").removeClass("on")):i.updateByType(o,u,{subscription:!0},{upgradeSubs:!1})},o.updateButton=function(n,r,o,u){var a=this;if(!n||n.length===0)n=e(".cointent");for(var f=0;f<n.length;f++){var l=e(n[f]),c=l.siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(a.isInvalid(c))continue;var h=c.data("publisher-id"),p=c.data("article-id"),d=c.data("branding"),v=r?"active":"inactive",m=u&&u.status==="active"||t.auth!==null?"loggedin":"loggedout",g={status:v,accessType:o,visible:"visible"},y={status:m,accessType:o};d&&(g.branding=d,y.branding=d),i.updateButton(h,p,g),u&&u.authResponse&&(y.email=u.authResponse.email,y.accountBalance=u.authResponse.accountBalance,u.linkToken&&(y.linkToken=u.linkToken)),s.update(h,p,y),this.isBuyButtonOn(h,p)||i.updateByType(h,p,{subscription:!1},{visible:"hidden"})}},o.ajaxSpinnerOff=function(t){t||(t=e(".ct-button")),t.removeClass("on").find(".spinner").addClass("off")},o.ajaxSpinnerOn=function(e){e.addClass("on").find(".spinner").removeClass("off")},o.reenableWidgetButtons=function(n){t.enableButton(e(".login")),e(".cointent-checkout-button").hasClass("purchased")||(t.enableButton(e(".cointent-checkout-button")),t.enableButton(e(".cointent-subscribe-button"))),t.enableButton(e(".cointent_logout"))},o.subscribeCallback=function(n,r){n.preventDefault();var i=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(this.isInvalid(i))return;if(r)this.onCheckout(n,"subscribe");else{t.emitter.emit("manageclick",i);var s=document.getElementById("cointent_lightbox");s&&e(s).removeClass("cointent_signup cointent_signup_large").addClass("cointent_manage")}return!1},o.upgradeSubCallback=function(n){n.preventDefault();var r=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(this.isInvalid(r))return;t.emitter.emit("upgradesubclick",r);var i=document.getElementById("cointent_lightbox");return i&&e(i).removeClass("cointent_signup cointent_signup_large").addClass("cointent_upgrade"),!1},o.onCheckout=function(n,r){var i=e(n.delegateTarget),s=i.closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");s.length<=0&&(s=e(".cointent-gumshoe")),n.preventDefault();if(t.isButtonDisabled(i))return;t.emitter.emit("focus"),t.emitter.emit(r,!1,s);var o="unknown";return r==="unlock"?o="buy_button":o="subscribe_button",t.track("click",{component:"widget",page:o,publisher:s.data("publisher-id"),article:s.data("article-id"),price:s.data("price"),balance:t.getUserBalance(),user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),!1},o.updateLoggedInMessaging=function(n){var r=this,i=function(n){n.preventDefault();var i=e(n.delegateTarget).closest(".cointent").siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");if(r.isInvalid(i))return;if(t.isButtonDisabled(e(this)))return;return t.disableButton(e(this)),t.emitter.emit("logoutclick"),!1};n&&e(".videoLoginTab").find(".cointent_logout").off(u).on(u,i)},o.updateWidget=function(t){if(t.buyButtonOn===0||t.buyButtonOn===1)this.widgetViewSettingsServer[t.publisherId+"-"+t.articleId]||(this.widgetViewSettingsServer[t.publisherId+"-"+t.articleId]={}),this.widgetViewSettingsServer[t.publisherId+"-"+t.articleId].buyButton=t.buyButtonOn===1?"on":"off";if(t.price||t.price===0){var n={expiry:t.expiry,articlePrice:t.price,verbs:{buy:t.buyVerb,subscription:t.subscriptionVerb},currency:{publisher:t.publisherCurrency,user:t.userCurrency}};t.conversionRate>0&&t.price>0&&(n.convertedPrice=t.conversionRate*t.price),this.isBuyButtonOn(t.publisherId,t.articleId)&&(n.visible="fade_in"),this.collection_widgets[t.publisherId]&&this.collection_widgets[t.publisherId][t.articleId]&&this.collection_widgets[t.publisherId][t.articleId].update(n)}t.visible===!1&&(i.updateByType(t.publisherId,t.articleId,{subscription:!0},{status:"deleted"}),e("#cointent_"+t.publisherId+"_"+t.articleId).find(".cointent-or").remove());if(!this.isBuyButtonOn(t.publisherId,t.articleId)){var r=e("#cointent_"+t.publisherId+"_"+t.articleId);r.addClass("buyButtonOff"),r.find(".cointent-or").removeClass("on"),i.updateByType(t.publisherId,t.articleId,{subscription:!1},{visible:"hidden"})}},o.invalidateWidget=function(e){var t=this;if(e.gating){var n="Invalid setup";e.error&&e.error.code&&(e.error.code==7002?n="Invalid Publisher":e.error.code==7005?n="Invalid Domain":e.error.code==7018&&(n="Invalid Article ID"));var r=e.gating.publisherId,s=e.gating.articleId,o=t.widgetCache[r+"-"+s];if(o){var u=o.siblings(".cointent-widget,.cointent-edgeworth,.cointent-video");u.data("invalid","1"),o.find(".cointent-or").removeClass("on"),i.updateByType(r,s,{subscription:!0},{visible:"hidden"}),i.updateByType(r,s,{subscription:!1},{visible:"visible",status:"invalid",accessType:n}),o.find(".cointent-ph-button").css("display","none")}}},o.isInvalid=function(e){return typeof e.data("invalid")!="undefined"},o.isBuyButtonOn=function(e,t){var n=this,r="on";return n.widgetViewSettingsClient[e+"-"+t]&&n.widgetViewSettingsClient[e+"-"+t].buyButton?r=n.widgetViewSettingsClient[e+"-"+t].buyButton:n.widgetViewSettingsServer[e+"-"+t]&&n.widgetViewSettingsServer[e+"-"+t].buyButton&&(r=n.widgetViewSettingsServer[e+"-"+t].buyButton),r=="on"},o.onLogout=function(){var t=e(".cointent");for(var n=0;n<t.length;n++)this.resetPublisherInfo(e(t[n]),!0);this.updateButton(t,!0),s.updateAll({status:"loggedout"}),this.updateSubscriptionOptionsButton(t,!0,null),e(".cointent_logo").addClass("on"),this.bindEvents()},o.onLogin=function(n){this.updateLoggedInMessaging(!0),t.emitter.emit("updateWidget",n.authResponse);if(n){if(n.authResponse){var r="";n.gating&&(r=n.gating.type),s.updateAll({status:"loggedin",accountBalance:n.authResponse.accountBalance,email:n.authResponse.email,accessType:r})}if(n.gating){var i=e(".cointent");this.updateSubscriptionOptionsButton(i,!n.gating.access,n.gating)}}this.bindEvents()},o.init(),o}),ctRequire.define("widget/meter",["jquery","utils/utils","config/config","widget/collection_button","widget/collection_messaging"],function(e,t,n,r,i){var s={};return s.state={meterpassed:!1,accessType:null},s.props={meterArticles:10,meterTimeframe:"month",meterType:"page",publisherId:0,articleId:0},s.init=function(t){var n=this;for(var r in t)this.state[r]!==undefined&&(this.state[r]=t[r]),this.props.hasOwnProperty(r)&&(this.props[r]=t[r]);cointent.ready(function(){cointent.meterPass(n.props.meterType,n.props.meterTimeframe,n.props.meterArticles,n.props.publisherId,n.props.articleId)?(cointent.meterTick(),n.state.meterpassed=!0,e(".cointent_metergated").addClass("active").removeAttr("hidden"),e(".cointent").addClass("hidden").attr("hidden","hidden")):(e(".cointent_metergated").removeClass("active").attr("hidden","hidden"),e(".cointent").removeClass("hidden").removeAttr("hidden")),n.state.accessType=cointent.meterAccessType(n.props.meterType,n.props.meterTimeframe,n.props.meterArticles,n.props.publisherId,n.props.articleId),n.renderMeter(),cointent.addLockCallback(function(e){n.onLock(e)}),cointent.addUnlockCallback(function(e){n.onUnlock(e)})})},s.renderMeter=function(){var t=e('<div class="cointent_meter_counter"></div>').appendTo("body"),n=e("<div></div>").appendTo(t);n.append("<p>"+this.getMeterMessage()+"</p>"),n.append("<p><span>Have an account? </span><a onClick='cointent.login("+this.props.publisherId+");'>Login</a><span> | "+"Ready to Subscribe? </span><a onClick='cointent.subscribe("+this.props.publisherId+", "+this.props.articleId+");'>Click here</a></p>"),e('<div class="cointent_close"></div>').on("click",function(){t.removeClass("active")}).appendTo(n),setTimeout(function(){t.addClass("active")},1500)},s.getMeterMessage=function(){var e=cointent.getMeter(this.props.meterType,this.props.meterTimeframe),t="",n="";switch(this.state.accessType){case"meter":parseInt(this.props.meterTimeframe,10)>0&&(n=" days"),t="You have read "+e+" of "+this.props.meterArticles+" in the past "+this.props.meterTimeframe+n;break;case"bypass":t="Thank you for being a loyal reader, we have temporarily turned off our free viewing limit";break;case"viewed":t="You have previously viewed this article";break;default:t="You have read all of your available articles this "+this.props.meterTimeframe+". Please consider purchasing for continued access."}return t},s.onLock=function(){this.state.meterpassed||e(".cointent_metergated").removeClass("active")},s.onUnlock=function(){e(".cointent_metergated").addClass("active")},s}),ctRequire.define("widget/text",["jquery","utils/utils","config/config","widget/response","widget/widget","widget/meter"],function(e,t,n,r,i,s){var o={};return o.init=function(){var n=this,r=e(".cointent-widget");if(r.length>0){for(var o=0;o<r.length;o++){var u=e(r[o]),a=u.closest(".cointent_gated");if(a.length>0)continue;i.buildWidget(u),u.data("meter-type")!==undefined&&u.data("meter-type")!=="off"&&s.init(u.data())}i.bindEvents(),e(document).on("articleReloadedCB",function(e,t){i.onArticleReload(e,t)}),t.emitter.on("updateWidget",function(e){n.updateWidget(e)}),t.emitter.on("logout",function(){n.onLogout()})}},o.onLogout=function(){i.updateLoggedInMessaging(!1)},o.updateWidget=function(e){e.experiments&&this.processExpVariantsVisuals()},o.processExpVariantsVisuals=function(){},o.isFreeCreditActive=function(){var e=!1,n=t.getVariant("publisher","freeCredit",i.publisherId);return n=="on"&&(e=!0),e},o}),ctRequire.define("widget/linkbtn",["jquery","utils/utils","config/config","widget/widget"],function(e,t,n,r){var i={},s="click touchstart";return i.init=function(){var n=this,r=e(".cointent-link");if(r.length>0){for(var i=0;i<r.length;i++){var s=e(r[i]);n.buildWidget(s)}n.bindEvents(),t.emitter.on("linksuccess",function(e){n.updateWidget(e.authResponse.publisherId)}),t.emitter.on("logout",function(){n.onLogout()}),t.emitter.on("updateLinkToken",function(e){n.updateWidget(e)})}},i.buildWidget=function(n){var r=n.data("publisher-id"),i=e('<button class="cointent_linkbutton ct-button cointent-checkout-button" data-publisher-id="'+r+'"></button>'),s=e('<span class="confirm_buttontext"></span>').appendTo(i);s.append('<div class="button_overlay"></div><div class="spinner off" ></div>'),s.prepend('<span class="button_text">Link your CoinTent Account</span>');var o=e('<div class="cointent"></div>');o.append(i),o.insertAfter(n);var u=t.getAuthTokenExternal();u.linktoken&&u.publisher&&u.publisher==r&&i.addClass("purchased").find(".button_text").html("CoinTent Linked")},i.bindEvents=function(){e("button.cointent_linkbutton").on(s,function(n){n.preventDefault();var r=e(n.target).closest("button.cointent_linkbutton");if(!r.hasClass("purchased")){var i=r.data("publisher-id");t.emitter.emit("linkpublisherclick",i)}})},i.onLogout=function(){e("button.cointent_linkbutton").removeClass("purchased").find(".button_text").html("Link your CoinTent Account")},i.updateWidget=function(t){e("button.cointent_linkbutton").each(function(n){var r=e(this);r.data("publisher-id")==t&&r.addClass("purchased").find(".button_text").html("CoinTent Linked")})},i}),ctRequire.define("widget/edgeworth",["jquery","utils/utils","config/config","widget/widget"],function(e,t,n,r){var i={};return i.clickEventType="click touchstart",i.cookieName="cointent-edgeworth",i.cookieOptions={expires:3652,domain:window.location.hostname,path:"/"},i.$box=null,i.initCompleted=null,i.hasAccess=null,i.forceOff=!0,i.widgetHeight=120,i.init=function(){var n=this,r=e(".cointent-edgeworth");if(r.length>0){var i=e(r[0]),s=i.data("publisher-id"),o=i.data("article-id"),u=i.data("widget-mode"),a=i.data("show-at-view"),f=i.data("reshow-after-close"),l=i.data("widget-button");n.updateViewsInCookie(),n.updateForceOff(a,f),n.updateTracking(s,o,u,a,f);var c=!1;e(window).width()<641&&(c=!0,n.forceOff=!0);if(!n.forceOff)n.createCustomWidget(i),n.createSliderBox(i,u),n.bindEvents(s,o,l),t.emitter.on("updateWidget",function(e){n.updateWidget(e)}),t.emitter.on("logout",function(){n.onLogout()}),t.emitter.on("accessChange",function(e,t,r,i){n.hasAccess=!!r,n.updateSlider()}),t.emitter.once("initcomplete",function(){n.initCompleted=!0,n.updateSlider()}),t.isAuthTokenUndefined()&&t.insertInitStatus(s,o,function(){});else{var h="closed";c&&(h="mobile"),n.track("view",{display:"off",reason:h})}}},i.defaultText={leftColumnTitle:"Want to take your readership to the next level?",leftColumnText:"Get access to unlimited premium content, our webinars, and more. If we are useful to you or your company, please consider subscribing today. Thank You!",rightColumnTitle:"Subscription Info",rightColumnText:"Unlimited access to premium content, annual print companion, free access to webinars.",buttonText:"Subscribe now",adfreeButtonText:"Go Ad-free"},i.createCustomWidget=function(t){var n=this;if(t.children().length==0){var r=n.defaultText;t.data("widget-button")&&t.data("widget-button")=="adfree"&&(r.buttonText=r.adfreeButtonText),t.data("left-column-title")&&(r.leftColumnTitle=t.data("left-column-title")),t.data("left-column-text")&&(r.leftColumnText=t.data("left-column-text")),t.data("right-column-title")&&(r.rightColumnTitle=t.data("right-column-title")),t.data("right-column-text")&&(r.rightColumnText=t.data("right-column-text")),t.data("button-text")&&(r.buttonText=t.data("button-text"));var i="",s="";t.data("left-column-text-color")&&(i+="color: "+t.data("left-column-text-color").replace(";","")+";"),t.data("left-column-background")&&(i+="background: "+t.data("left-column-background").replace(";","")+";"),t.data("right-column-text-color")&&(s+="color: "+t.data("right-column-text-color").replace(";","")+";"),t.data("right-column-background")&&(s+="background: "+t.data("right-column-background").replace(";","")+";"),t.data("widget-height")&&(n.widgetHeight=parseInt(t.data("widget-height"))),t.css("height",n.widgetHeight+"px");var o=e('<div class="leftColumn" style="'+i+'"></div>');o.append(e('<div class="textContainer"><div class="leftColumnTitle">'+r.leftColumnTitle+"</div><div>"+r.leftColumnText+"</div></div>")),t.append(o);var u=e('<div class="rightColumn" style="'+s+'"></div>');u.append(e('<div class="textContainer"><div class="rightColumnTitle">'+r.rightColumnTitle+"</div><div>"+r.rightColumnText+'</div><div><a href="#" id="ct-edegeworth-subscribe" class="subscribeButton">'+r.buttonText+"</a></div></div>")),t.append(u)}},i.bindEvents=function(t,r,i){var s=this;i=="adfree"?e("#ct-edegeworth-subscribe").on(s.clickEventType,function(e){e.preventDefault(),s.track("click",{button:"adfree"}),window.location=n.SITE_URI+"/chrometrial?utm_source=publisher&utm_medium="+t}):e("#ct-edegeworth-subscribe").on(s.clickEventType,function(e){e.preventDefault(),window.cointent.subscribe(t,r),s.track("click",{button:"subscribe"})})},i.createSliderBox=function(n,r){var i=this,s=t.isIE8()?"ie8":"";r!="float_over_screen"&&r!="float_over_page"&&r!="push_down_page"&&(r="push_down_page"),i.$box=e('<div id="cointent-edgeworth-container" class="'+r+" "+s+'"></div>'),i.$box.append(n),e('<div class="cointent_close"></div>').appendTo(i.$box).on(i.clickEventType,function(){i.closeSlider(),i.track("click",{button:"close"})});if(r=="push_down_page"){var o=parseInt(e("body").css("margin-top"))+parseInt(e("body").css("padding-top")),u=parseInt(e("body").css("margin-left"))+parseInt(e("body").css("padding-left"));i.$box.css("top","-"+o+"px"),i.$box.css("left","-"+u+"px"),i.$box.prependTo(e("body")).css("width","100%").css("width","+="+u*2+"px"),e(window).resize(function(){i.$box.css("width","100%").css("width","+="+u*2+"px")})}else i.$box.appendTo(e("body"))},i.updateSlider=function(){var e=this;e.initCompleted&&(e.hasAccess===!1?e.forceOff?e.track("view",{display:"off",reason:"closed"}):(e.$box.animate({height:e.widgetHeight+"px"},1e3,"swing"),e.track("view",{display:"on"})):e.hasAccess===!0&&(e.closeSlider(),e.track("view",{display:"off",reason:"access"})))},i.closeSlider=function(){var e=this;e.forceOff=!0,e.$box.find(".cointent_close").remove(),e.$box.animate({height:"0px"},1e3,"swing");var t=e.getCookie();t.closeTime=(new Date).getTime()/1e3,e.saveCookie(t)},i.onLogout=function(){r.updateLoggedInMessaging(!1)},i.updateWidget=function(e){e.experiments&&this.processExpVariantsVisuals()},i.processExpVariantsVisuals=function(){},i.updateForceOff=function(e,t){var n=this;e=parseInt(e),e=isNaN(e)?0:e,e=Math.min(Math.max(e,0),100),t=parseInt(t),t=isNaN(t)?0:t,t=Math.min(Math.max(t,-1),36500);var r=n.getCookie();r.closeTime>0&&t==-1?n.forceOff=!0:e==0?n.forceOff=!0:r.closeTime+86400*t<(new Date).getTime()/1e3?r.pageVisit>=e&&(n.forceOff=!1):n.forceOff=!0},i.trackParams={component:"edgeworth"},i.updateTracking=function(e,t,n,r,i){var s=this;s.trackParams.publisher=e,s.trackParams.article=t,s.trackParams.widgetMode=n,s.trackParams.showAtView=r,s.trackParams.reshowAfterClose=i},i.track=function(n,r){var i=this,s=i.getCookie(),o={url:window.location.href,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe,visits:s.pageVisit},u=e.extend({},r,i.trackParams,o);t.track(n,u)},i.updateViewsInCookie=function(){var e=this,t=e.getCookie();t.pageVisit=t.pageVisit+1,e.saveCookie(t)},i.getCookie=function(){var t=this,n=e.cookie(t.cookieName);return n?n=e.parseJSON(n):n={pageVisit:0,closeTime:0},n},i.saveCookie=function(t){var n=this,r=JSON.stringify(t);e.cookie(n.cookieName,r,n.cookieOptions)},i}),ctRequire.define("utils/track",["require","utils/utils","jquery"],function(e){var t=e("utils/utils"),n=e("jquery"),r={};return r.setup=function(){typeof cointent_tracking_data=="undefined"&&(window.cointent_tracking_data={});var e=document.getElementById("cointent_td");e!==null&&(window.cointent_tracking_data.publisherId||(window.cointent_tracking_data.publisherId=e.dataset.publisherId),window.cointent_tracking_data.articleId||(window.cointent_tracking_data.articleId=e.dataset.articleId),e.dataset["debugger"]&&t.activateDebugger())},r.init=function(e){if(window.cointent_tracking_data.tracked===!0)return!1;var r={component:"tracker",publisher:window.cointent_tracking_data.publisherId+"",user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,url:window.location.href};e!=="undefined"&&(r.adblock=e?1:0),window.cointent_tracking_data.publisherId&&window.cointent_tracking_data.articleId?(r=n.extend({page:"article_view",gated:window.cointent_tracking_data.gated?1:0,article:window.cointent_tracking_data.articleId+""},r),t.debuggerPrint("Tracking article view ",r),t.track("view",r)):cointent_tracking_data.publisherId&&(r.page="homepage_view",t.debuggerPrint("Tracking home page view",r),t.track("view",r)),cointent_tracking_data.tracked=!0},r}),ctRequire.define("utils/adblock",["jquery","utils/utils","config/config","widget/collection_button","widget/collection_messaging","utils/track"],function(e,t,n,r,i,s){var o={};return o.state={price:"",render:!0,trackedGating:!1,expiry:0,renderOption:"",publisher:0,article:0,subscription:!1,closeTimer:0,callbacks:[],override:{},blocking:{gating:null,pricing:null,active:null,adBlock:null,gsMode:null,popupInactive:!0},uiElements:{customButtonText:"Subscribe",logoSize:"",backgroundColor:"#FFFFFF",closeButton:!1,perSession:!1,headerText:"Please consider turning off your ad blocker for our site",subHeaderText:"We depend on advertising revenue to create articles like this one.  Please whitelist our site or pay for access.",logo:"",url:"//connect.cointent.com/images/journalist-writing.jpg",imageWidth:330,whitelistText:"View with Ads"},targeting:{showAfterCount:1,showAfterTime:0,excludeSource:[],excludeDevice:[]},replacements:{hori:"//connect.cointent.com/images/gsreplace1.png",vert:"//connect.cointent.com/images/gsreplace2.png",squa:"//connect.cointent.com/images/gsreplace3.png"}},o.localstorageName="gumshoe",o.LIST_MAX_SIZE=1e3,o.cookieName="cointent-gumshoe",o.cookieOptions={domain:window.location.hostname,path:"/"},o.init=function(r){var s=this,o=this.state.uiElements,u=this.state.targeting,a=this.state.replacements,f=e(".cointent-gumshoe");if(f.length>0){t.debuggerPrint("Initializing Ad Block"),s.beginSession(),this.state.article=f.data("article-id"),this.state.publisher=f.data("publisher-id"),this.state.uiElements.logoSize=f.data("logo-size")?f.data("logo-size"):o.logoSize,this.state.uiElements.headerText=f.data("header-text")?f.data("header-text"):o.headerText,this.state.uiElements.subHeaderText=f.data("subheader-text")?f.data("subheader-text"):o.subHeaderText,this.state.uiElements.url=f.data("url")?f.data("url"):o.url,this.state.uiElements.logo=f.data("logo")?f.data("logo"):o.logo,this.state.uiElements.imageWidth=f.data("image-width")?parseInt(f.data("image-width")):o.imageWidth,this.state.uiElements.backgroundColor=f.data("background-color")?f.data("background-color"):o.backgroundColor,this.state.uiElements.closeButton=typeof f.data("close-button")!="undefined"?f.data("close-button"):o.closeButton,this.state.uiElements.perSession=typeof f.data("per-session")!="undefined"?f.data("per-session"):o.perSession,this.state.uiElements.whitelistText=f.data("whitelist-text")?f.data("whitelist-text"):o.whitelistText,this.state.message=i.create({publisher:this.state.publisher,article:this.state.article,component:"adblock"}),this.state.renderOption=f.data("render-option")?f.data("render-option"):this.state.renderOption,this.state.subscription=f.data("subscription-button")?f.data("subscription-button"):this.state.subscription,this.state.closeTimer=f.data("timer")?parseInt(f.data("timer")):this.state.timer,this.state.targeting.showAfterCount=f.data("show-after-count")?parseInt(f.data("show-after-count")):u.showAfterCount,this.state.targeting.showAfterTime=f.data("show-after-time")?parseInt(f.data("show-after-time")):u.showAfterTime,this.state.targeting.excludeSource=f.data("exclude-source")?s.filterSources(f.data("exclude-source")):u.excludeSource,this.state.targeting.excludeDevice=f.data("exclude-device")?s.filterDevices(f.data("exclude-device")):u.excludeDevice,this.state.replacements.hori=typeof f.data("replacement-hori")!="undefined"?f.data("replacement-hori"):a.hori,this.state.replacements.vert=typeof f.data("replacement-vert")!="undefined"?f.data("replacement-vert"):a.vert,this.state.replacements.squa=typeof f.data("replacement-squa")!="undefined"?f.data("replacement-squa"):a.squa,(f.data("debugger")||this.state.debugger)&&t.activateDebugger(),this.state.uiElements.imageWidth=Math.max(230,Math.min(this.state.uiElements.imageWidth,530));var l={publisher:this.state.publisher,article:this.state.article,ctClient:t.cointentClientId,ref:document.referrer,sutm:t.sessionUtmCookie,utm:t.articleUtmCookie,pd:t.publisherDataForServer};e('<div id="cointent_'+this.state.publisher+"_"+this.state.article+'"></div>').insertAfter(f);var c=e("<iframe></iframe>");c.attr({src:n.SITE_URI+"/initStatus?"+e.param(l),id:"cointent_action_iframe",width:1,height:1,border:0,frameborder:0,style:"width:1px !important;height:1px !important; display:block !important;"}).insertAfter(f),this.pricingCallback=function(e){if(typeof e.price!="undefined"||typeof e.expiry!="undefined")s.state.price=e.price?e.price:s.state.price,s.state.expiry=e.expiry?e.expiry:s.state.expiry,s.state.blocking.pricing=!0,t.debuggerPrint("Received Pricing Data"),s.render()},this.adBlockCallback=function(e){s.state.blocking.active=e===1?!0:!1,s.state.blocking.active===!0?(t.debuggerPrint("Ad Block Feature: Active"),s.render()):(t.debuggerPrint("Ad Block Feature: Inactive"),s.disable())},this.gsModeCallback=function(e){s.state.blocking.gsMode=!0,e=="padblock"&&t.isChrome()&&(s.state.renderOption="padblock"),s.render()},t.emitter.on("adBlockRenderComplete",function(){s.renderPurchaseButton()}),this.preloadImages(this.state.uiElements.url,this.state.uiElements.logo),this.authResponseCallback=function(e){e.email&&(s.state.email=e.email,s.state.accountBalance=e.accountBalance);var n=t.auth!==null?"loggedin":"loggedout",r={status:n,accessType:s.state.accessType,email:s.state.email,accountBalance:s.state.accountBalance};i.update(s.state.publisher,s.state.article,r)},this.gatingCallback=function(n){s.state.blocking.gating=n.access,s.state.accessType=n.type,n.access===!1?(s.render(),t.debuggerPrint("Access Data Received: user does not have access"),s.state.popup&&!e("#cointent_lightbox").is(":visible")&&s.showPopup()):(t.debuggerPrint("Access Data Received: user has access"),s.destroyPopup(),s.disable(!0))},t.emitter.on("autoClosePopup",function(){s.showPopup()}),t.emitter.on("updateAuthResponse",this.authResponseCallback),t.emitter.on("updateAdBlock",this.adBlockCallback),t.emitter.on("updateGumshoeMode",this.gsModeCallback),t.emitter.on("updateWidget",this.pricingCallback),t.emitter.on("updateGating",this.gatingCallback)}},o.destroyPopup=function(){t.debuggerPrint("Popup Destroyed"),this.state.popup&&(this.state.popup.remove(),this.state.popup=null),this.state.callbacks.hide&&(this.state.callbacks.show=null,this.state.callbacks.hide.call()),this.state.popupInactive=!0},o.setupParams=function(e){if(!e)return;this.state.render=e.render!=="undefined"?e.render:this.state.render},o.activate=function(e){t.debuggerPrint("Ad Block Feature Active"),this.state.blocking.active=!0,e&&(t.debuggerPrint("User Has Ad Block On"),this.state.blocking.adBlock=!0);var n=this.getBlockingState();n.adBlock!==!0&&(t.debuggerPrint("No Ad Block Detected"),o.disable()),this.render()},o.disable=function(e){t.debuggerPrint("Ad Block Disabled"),this.closeCallback(),this.pricingCallback&&t.emitter.off("updateWidget",this.pricingCallback),this.authResponseCallback&&t.emitter.off("updateAuthResponse",this.authResponseCallback),this.adBlockCallback&&t.emitter.off("updateAdBlock",this.adBlockCallback),this.gsModeCallback&&t.emitter.off("updateGumshoeMode",this.gsModeCallback),this.gatingCallback&&t.emitter.off("updateGating",this.gatingCallback)},o.preloadImages=function(){for(var t=0;t<arguments.length;t++)e("<img />").attr("src",arguments[t])},o.onTransitionEnd=function(e){e.state.modal&&e.state.modal.remove(),e.state.popup&&e.state.popup.remove()},o.closeCallback=function(t){var n=this;n.state.modal&&(n.state.modal.css({opacity:0}),e("body").removeClass("cointent_modal_dark_open")),n.state.popup&&(n.state.popup.css({opacity:0}),n.state.popup.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",n.onTransitionEnd)),setTimeout(function(){n.onTransitionEnd(n)},400)},o.getBlockingState=function(){return e.extend({},this.state.blocking,this.state.override)},o.canRender=function(){var e=this.getBlockingState();for(var t in e){if(!e.hasOwnProperty(t))continue;if(e[t]===null)return!1}return!0},o.renderWhitelist=function(){var n=this.state.popup,r=this.state.whitelist,i=this;if(!n||n.length<=0)n=this.state.popup=e('<div id="ct_gumshoe" class="cointent" style="background-color:'+this.state.uiElements.backgroundColor+';"><div class="ct_gumshoe_inner"></div></div>'),n.appendTo("body").css("opacity",1);if(r&&r.length>0)r.show();else{r=e('<div class="ct_whitelist"></div>'),r.append("<h1>How to View Site With Ads</h1>").append('<p class="ct_whitelist_error"></p>').append("<p>You can either whitelist our site or disable your ad block software to continue.</p>").append('<div class="ct_specifics"><p class="ct_whitelist_header">On AdBlock Plus</p><ol><li>Click the AdBlock Plus icon on your browser</li><li>Click Enabled on this site"</li><li>Reload the page</li></ol></div>').append('<div class="ct_specifics"><p class="ct_whitelist_header">On AdBlock </p><ol> <li>Click the AdBlock icon on your browser</li><li> Click Dont run on pages on this domain</li><li> Reload the page</ol></div>').append('<div class="ct_specifics mobile"><p class="ct_whitelist_header">On Purify</p><ol><li>In Safari, click the share icon.</li> <li>In the bottom row find and click the "Purify Actions" button, it may be hidden under "More"</li><li>Refresh the page</li></ol></div>');var s=e('<button class="ct-button flat"><span class="confirm_buttontext"><span class="button_text">Refresh This Page</span></span></button>').on("click",function(e){i.recheckAdBlock(e)}),o=e('<button class="ct-button flat outline"><span class="confirm_buttontext"><span class="button_text">Back</span></span></button>').on("click",function(e){n.find(".ct_gumshoe_inner").css("opacity",1).show(),r.css("opacity",0).hide()});e('<div class="ct_gumshoe_button_ctr"></div>').append(o).append(s).appendTo(r),n.find(".ct_gumshoe_inner").animate({opacity:0},500,"linear",function(){n.find(".ct_gumshoe_inner").hide(),n.append(r),r.css("opacity",1)}),t.track("view",{component:"adblock",page:"whitelist",url:window.location.href,publisher:this.state.publisher,article:this.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe})}},o.recheckAdBlock=function(e){var n=this,r=function(e){e?location.reload():n.closeCallback()};n.state.popup.find(".ct_whitelist_error").hide(),t.isAdBlocked(r)},o.renderPurchaseButton=function(){var t={expiry:this.state.expiry,branding:"messaging",price:this.state.price,visible:"visible",publisher:this.state.publisher,article:this.state.article,component:"adblock",flat:!0};this.state.subscription&&(t.subscription=!0);var n=r.createButton(t),s=i.render(this.state.publisher,this.state.article);e(".cointent_purchase_button").append(n).append(s)},o.render=function(){var n=this,r=e('<div id="ct_gumshoe" class="cointent '+this.state.renderOption+'" style="background-color:'+this.state.uiElements.backgroundColor+'; display:none;"></div>'),i=e('<div class="ct_gumshoe_inner"></div>').appendTo(r);if(!this.canRender())return;if(n.wasRecentlyClosed()&&this.state.uiElements.perSession){t.debuggerPrint("The window was recently closed, not rendering");return}if(!n.targetingMet())return;e("body").append(r),this.state.popup&&this.state.popup.replaceWith(r),this.state.popup=r,t.track("view",{component:"adblock",page:"main",url:window.location.href,publisher:this.state.publisher,article:this.state.article,render_option:this.state.renderOption,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),this.state.blocking.popupInactive=null;if(this.state.render===!1){t.isFunction(n.state.callbacks.render)&&(n.state.callbacks.render.call(undefined),n.state.callbacks.render=null),t.debuggerPrint("Ad Block Custom Popup Render Called");return}t.debuggerPrint("Ad Block Default Popup Render Called");switch(this.state.renderOption){case"replacements":t.debuggerPrint("Rendering with replacements only"),this.buildReplacements();break;case"heartBuyOnly":case"nonWhitelist":t.debuggerPrint("Rendering with Option: "+this.state.renderOption),this.buildNonWhitelistUI(i),r.addClass("nonWhitelist");break;default:t.debuggerPrint("Rendering Default"),this.buildDefaultUI(i,this.state.renderOption)}},o.buildDefaultUI=function(n,r){var s,o=this;this.state.modal||(this.state.modal=e('<div class="cointent_modal_dark"></div>').appendTo("body"),e("body").addClass("cointent_modal_dark_open")),n.append('<div class="ct_gumshoe_image" style="background-image:url('+this.state.uiElements.url+');"/>'),s=e('<div class="ct_gumshoe_rightpanel"></div>').appendTo(n),this.state.uiElements.logo&&s.append('<img class="ct_logo '+this.state.uiElements.logoSize+'" src="'+this.state.uiElements.logo+'"/>'),s.append('<div class="ct_gumshoe_header">'+this.state.uiElements.headerText+"</div>").append('<div class="ct_gumshoe_subheader">'+this.state.uiElements.subHeaderText+"</div>");var u=e('<div class="ct_gumshoe_button_ctr"></div>');r.search("customButton")>=0?this.setUpCustomButton(u):r.search("buyOnly")===0?this.setupBuyOnlyUIButtons(u):r==="viewOnly"||r.search("tronc")>=0?this.setupWhitelistOnlyUIButtons(u):r==="padblock"?this.setupPadblockButtons(u):this.setupDefaultUIButtons(u),this.setUpCustomButtonTrigger(),o.state.uiElements.imageWidth!=parseInt(e("div.ct_gumshoe_image").css("width"))&&parseInt(e("div.ct_gumshoe_rightpanel").css("padding-left"))>200&&(e("div.ct_gumshoe_image").css("width",o.state.uiElements.imageWidth+"px"),e("div.ct_gumshoe_rightpanel").css("padding-left",o.state.uiElements.imageWidth+20+"px"));var a=i.render(o.state.publisher,o.state.article);u.appendTo(s).append(a);var f="",l=null;if(this.state.uiElements.closeButton){var c=e('<div class="cointent_close '+f+'"></div>').on("click",function(e){t.track("click",{component:"adblock",page:"close",url:window.location.href,publisher:o.state.publisher,article:o.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),o.closeCallback(e),o.saveClosureTime()});if(this.state.closeTimer>0){c.hide(),l=e('<div class="cointent_timer_message">you can close in '+this.state.closeTimer+" seconds</div>").appendTo(n);var h=this.state.closeTimer,p=setInterval(function(){h=Math.max(0,h-1),n.find("div.cointent_timer_message").html("you can close in "+h+" seconds"),h<=0&&clearInterval(p)},1e3);setTimeout(function(){l.fadeOut(),c.fadeIn()},this.state.closeTimer*1e3)}c.appendTo(n)}t.emitter.on("loginclick",function(e){o.hidePopup()}),window.cointent.addCloseCallback(function(){o.showPopup()}),this.state.popup.css({opacity:1,display:"block"})},o.setUpCustomButton=function(n){var r=this,i=e('<button class="ct-button flat large primary"><span class="confirm_buttontext"><span class="button_text">'+this.state.uiElements.customButtonText+"</span></span></button>").on("click",function(e){t.emitter.emit("customButtonClick",e),r.hidePopup()});n.append(i)},o.setUpCustomButtonTrigger=function(){var n=this;e(".customButtonTrigger").on("click",function(e){t.emitter.emit("customButtonClick",e),n.hidePopup()})},o.setupPadblockButtons=function(n){var r=this;e('<p class="padblockUppertext">Stay ad-free AND support us</p>').appendTo(n);var i=e('<button class="ct-button flat large primary"><span class="confirm_buttontext"><span class="button_text">Learn More</span></span></button>').on("click",function(e){t.track("click",{component:"padblock",page:"subscribe",url:window.location.href,publisher:r.state.publisher,article:r.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),window.open("https://cointent.com/subscribe/"+parseInt(r.state.publisher))});n.append(i);var s=e("<div></div>").appendTo(n),o=e('<p class="padblockSubtext">Or continue by unblocking ads for our site. </p>').appendTo(s);e("<a> Find out how. </a>").click(function(e){t.track("click",{component:"padblock",page:"whitelist",url:window.location.href,publisher:r.state.publisher,article:r.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),r.renderWhitelist(e)}).appendTo(o)},o.setupBuyOnlyUIButtons=function(e){var t=this,n=r.createButton({expiry:this.state.expiry,branding:"messaging",subscription:this.state.subscription,price:this.state.price,visible:"visible",publisher:this.state.publisher,article:this.state.article,component:"adblock",flat:!0,size:"large"});n.on("click",function(){t.hidePopup()}),e.append(n)},o.setupWhitelistOnlyUIButtons=function(n){var r=this,i=e('<button class="ct-button flat large secondary"><span class="confirm_buttontext"><span class="button_text">'+this.state.uiElements.whitelistText+"</span></span></button>").on("click",function(e){t.track("click",{component:"adblock",page:"whitelist",url:window.location.href,publisher:r.state.publisher,article:r.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),r.renderWhitelist(e)});n.append(i)},o.setupDefaultUIButtons=function(n){var i=this,s=r.createButton({expiry:this.state.expiry,branding:"messaging",subscription:this.state.subscription,price:this.state.price,visible:"visible",publisher:this.state.publisher,article:this.state.article,component:"adblock",flat:!0});s.on("click",function(){i.hidePopup()});var o=e('<button class="ct-button flat grey"><span class="confirm_buttontext"><span class="button_text">'+this.state.uiElements.whitelistText+"</span></span></button>").on("click",function(e){t.track("click",{component:"adblock",page:"whitelist",url:window.location.href,publisher:i.state.publisher,article:i.state.article,user_agent:navigator.userAgent,cointent_client_id:t.cointentClientId,user_id:t.getUserId(),user_id_maybe:t.userIdMaybe}),i.renderWhitelist(e)});n.append(o).append('<span class="cointent-or on">OR</span>').append(s)},o.buildNonWhitelistUI=function(s){var o,u,a=this;this.state.modal||(this.state.modal=e('<div class="cointent_modal_dark"></div>').appendTo("body"),e("body").addClass("cointent_modal_dark_open")),u=e('<div class="ct_gumshoe_panel nonWhitelist"></div>').appendTo(s).append('<div><img class="ct_logo '+this.state.uiElements.logoSize+'" src="'+this.state.uiElements.logo+'"/>'+'<img  src="'+n.CONNECT_URI+'/images/heartadblockers.png"/></div>').append('<div class="ct_gumshoe_header">'+this.state.uiElements.headerText+"</div>").append('<div class="ct_gumshoe_subheader">'+this.state.uiElements.subHeaderText+"</div>"),o=r.createButton({expiry:this.state.expiry,branding:"messaging",price:this.state.price,visible:"visible",publisher:this.state.publisher,subscription:this.state.subscription,article:this.state.article,component:"adblock",flat:!0,size:"large"});var f=i.render(a.state.publisher,a.state.article);e('<div class="ct_gumshoe_button_ctr"></div>').appendTo(u).append(o).append(f),o.on("click",function(){a.hidePopup()}),t.emitter.on("loginclick",function(e){a.hidePopup()}),window.cointent.addCloseCallback(function(){a.showPopup()}),this.state.popup.css({opacity:1,display:"block"})},o.buildReplacements=function(){var t=this,n=e("div[id^=google_ads_iframe_]");n.each(function(n,r){var i=e(r);if(i.height()==0){var s=i.find("iframe[id^=google_ads_iframe_]");if(s.length>0){var o=s.width(),u=s.height();o==728&&u==90?i.after(e('<div><img src="'+t.state.replacements.hori+'" /></div>')):o==160&&u==600?i.after(e('<div><img src="'+t.state.replacements.vert+'" /></div>')):o==300&&u==250&&i.after(e('<div><img src="'+t.state.replacements.squa+'" /></div>'))}}})},o.setOverrideValue=function(e,n){t.debuggerPrint("Setting Override of '"+e+"' with: '"+n+"'"),this.state.override[e]=n},o.showPopup=function(){this.state.popup&&this.state.popup.show(),this.state.callbacks.show&&this.state.callbacks.show.call()},o.hidePopup=function(){this.state.popup&&this.state.popup.hide(),this.state.callbacks.hide&&this.state.callbacks.hide.call()},o.filterSources=function(e){var t=e.split(","),n=["self","facebook","google","twitter"];for(var r=t.length-1;r>=0;r--)t[r]=t[r].toLowerCase(),n.indexOf(t[r])===-1&&t.splice(r,1);return t},o.filterDevices=function(e){var t=[];return e=="mobile"&&t.push(e),t},o.beginSession=function(){var t=this,n=(new Date).getTime()/1e3,r=e.cookie(t.cookieName);r?r=e.parseJSON(r):r={};if(!r.sessionBegin){r={sessionBegin:n};var i=JSON.stringify(r);e.cookie(t.cookieName,i,t.cookieOptions)}var s=t.getLocalStorage();s.visits.push(n);while(s.visits.length>t.LIST_MAX_SIZE)s.visits.shift();t.saveLocalStorage(s)},o.getSessionBeginTime=function(){var t=this,n=0,r=e.cookie(t.cookieName);return r&&(r=e.parseJSON(r),r.sessionBegin&&(n=r.sessionBegin)),n},o.saveClosureTime=function(){var e=this,t=e.getLocalStorage();t.closeTime=(new Date).getTime()/1e3,e.saveLocalStorage(t)},o.wasRecentlyClosed=function(){var e=this,n=e.getLocalStorage(),r=e.getSessionBeginTime(),i=!1;return n&&n.closeTime&&n.closeTime>r&&(t.debuggerPrint("Close time was "+n.closeTime+", session begin time was "+r),i=!0),i},o.targetingMet=function(){var e=this,n=(new Date).getTime()/1e3,r=Math.max(1,e.state.targeting.showAfterCount),i=n-Math.max(0,e.state.targeting.showAfterTime),s=e.state.targeting.excludeDevice,o=e.state.targeting.excludeSource,u=e.getLocalStorage(),a=1;for(var f=u.visits.length-2;f>=0;f--){if(u.visits[f]<i)break;a++}var l=!0;do{if(a<r){l=!1;break}if(s.length>0&&s[0]=="mobile"&&t.isMobile()){t.debuggerPrint("Excluding: Mobile"),l=!1;break}if(o.length>0){var c=window.location.hostname,h=t.parseUri(document.referrer).host;if(o.indexOf("facebook")!==-1&&h=="facebook.com"){t.debuggerPrint("Excluding: Facebook"),l=!1;break}if(o.indexOf("google")!==-1&&h=="google.com"){t.debuggerPrint("Excluding: Google"),l=!1;break}if(o.indexOf("twitter")!==-1&&h=="twitter.com"){t.debuggerPrint("Excluding: Twitter"),l=!1;break}if(o.indexOf("self")!==-1&&h==c){t.debuggerPrint("Excluding: Self ("+c+")"),l=!1;break}}}while(!1);return t.debuggerPrint("Visited "+a+" times now, required visit is "+r+" times, since "+e.state.targeting.showAfterTime+" sec."),t.debuggerPrint("Targeting met: "+(l?"Yes":"No")),l},o.getLocalStorage=function(){var n=this,r=t.storage.getItem(n.localstorageName),i=null;return r?i=e.parseJSON(r):i={closeTime:0,visits:[]},i},o.saveLocalStorage=function(e){var n=this,r=JSON.stringify(e);t.storage.setItem(n.localstorageName,r)},o.setCallback=function(e,n){return n!==null&&t.isFunction(n)?(this.state.callbacks[e]=n,!0):!1},o.initAdBlockExternal=function(e,t,n,r,i){o.setupParams(t),o.setCallback("render",n),o.setCallback("hide",r),o.setCallback("show",i),window.cointent.addClickCallback("login",r),window.cointent.addClickCallback("spend",r),window.cointent.addCloseCallback(i)},o}),ctRequire.define("utils/meter",["require","jquery-private","config/config","utils/events","utils/utils"],function(e,t,n,r,i){var s={};return s.isAutoMeter=!1,s.byHit={count:0,timestamps:[]},s.byPage={keys:[],timestamps:[]},s.byArticle={keys:[],timestamps:[]},s.bypass={start:0,days:0},s.currentTicks={byPage:[],byArticle:[]},s.LIST_MAX_SIZE=5e3,s.cookieOptions={expires:3652,domain:window.location.hostname,path:"/"},s.init=function(){var e=this;Date.now||(Date.now=function(){return(new Date).getTime()});var n=t("body");if(typeof n.data("cointent-meter")!="undefined"){var r=n.data("cointent-meter").toString().toLowerCase();if(r=="1"||r=="true"||r=="yes"||r=="on")e.isAutoMeter=!0;else if(r=="0"||r=="false"||r=="no"||r=="off")e.isAutoMeter=!1}e.loadFromStorage(),e.isAutoMeter&&e.meterTick()},s.meterTick=function(){var e=this,n,r=Math.floor(Date.now()/1e3);if(e.bypass.start>0&&e.bypass.days&&e.bypass.start+e.bypass.days*86400>r)return;var s;e.byHit.count++,e.byHit.timestamps.push(r);while(e.byHit.timestamps.length>e.LIST_MAX_SIZE)e.byHit.timestamps.shift();var o=i.md5(window.location.pathname);s=e.byPage.keys.indexOf(o),s!==-1&&(e.byPage.keys.splice(s,1),e.byPage.timestamps.splice(s,1)),e.byPage.keys.push(o),e.byPage.timestamps.push(r),s===-1&&e.currentTicks.byPage.push(o);while(e.byPage.keys.length>e.LIST_MAX_SIZE)e.byPage.keys.shift(),e.byPage.timestamps.shift();var u=t(".cointent-widget,.cointent-video"),a=[];if(u.length>0)for(n=0;n<u.length;n++){var f=t(u[n]),l=f.data("publisher-id"),c=f.data("article-id");a.push(l+"-"+c)}for(n=0;n<a.length;n++){s=e.byArticle.keys.indexOf(a[n]),s!==-1&&(e.byArticle.keys.splice(s,1),e.byArticle.timestamps.splice(s,1)),e.byArticle.keys.push(a[n]),e.byArticle.timestamps.push(r),s===-1&&e.currentTicks.byArticle.push(a[n]);while(e.byArticle.keys.length>e.LIST_MAX_SIZE)e.byArticle.keys.shift(),e.byArticle.timestamps.shift()}e.saveToStorage()},s.loadFromStorage=function(){var e=this,n=!1,r;i.storage.hasStorage()?(r=i.storage.getItem("meter"),r||(r=t.cookie("cointent-meter"),n=!0)):r=t.cookie("cointent-meter");if(r!==undefined&&r){var s=JSON.parse(r);if(n&&s.byPage&&s.byPage.keys)for(var o=0;o<s.byPage.keys.length;o++)s.byPage.keys[o]=i.md5(s.byPage.keys[o]);s.byHit&&(e.byHit=s.byHit),s.byPage&&(e.byPage=s.byPage),s.byArticle&&(e.byArticle=s.byArticle),s.bypass&&(e.bypass=s.bypass),n&&e.saveToStorage()}},s.saveToStorage=function(){var e=this,n={byHit:e.byHit,byPage:e.byPage,byArticle:e.byArticle,bypass:e.bypass},r=JSON.stringify(n);i.storage.hasStorage()?i.storage.setItem("meter",r):t.cookie("cointent-meter",r,e.cookieOptions)},s.setBypass=function(e){var t=this,n=Math.floor(Date.now()/1e3);t.bypass.start=n,t.bypass.days=e,t.saveToStorage()},s.clearBypass=function(e){var t=this;t.bypass.start=0,t.bypass.days=0,t.saveToStorage()},s.findIndexOfCutoff=function(e,t){var n=e.length-1;for(var r=0;r<e.length;r++)if(e[r]>=t){n=r;break}return n},s.getMeterWithCutoff=function(e,t){var n=this;e!="page"&&e!="article"&&(e="all"),t!="month"&&!(typeof t=="number"&&t%1===0&&t>0)&&(t="all");if(!n.byHit||!n.byPage||!n.byArticle)return console.error("getMeter() method called without proper object context!"),[null,null];var r=null,i=null,s=new Date,o=Math.floor(s.getTime()/1e3),u=Math.floor((new Date(s.getFullYear(),s.getMonth(),1)).getTime()/1e3),a=0;return typeof t=="number"&&(a=Math.max(0,o-86400*t)),e=="all"?t=="all"||n.byHit.count==0?(i=0,r=n.byHit.count):t=="month"?(i=n.findIndexOfCutoff(n.byHit.timestamps,u),r=n.byHit.timestamps.length-i):(i=n.findIndexOfCutoff(n.byHit.timestamps,a),r=n.byHit.timestamps.length-i):e=="page"?(t=="all"||n.byPage.keys.length==0?i=0:t=="month"?i=n.findIndexOfCutoff(n.byPage.timestamps,u):i=n.findIndexOfCutoff(n.byPage.timestamps,a),r=n.byPage.timestamps.length-i):e=="article"&&(t=="all"||n.byArticle.keys.length==0?i=0:t=="month"?i=n.findIndexOfCutoff(n.byArticle.timestamps,u):i=n.findIndexOfCutoff(n.byArticle.timestamps,a),r=n.byArticle.timestamps.length-i),[r,i]},s.meterPass=function(e,n,r,s,o){var u=this,a,f=parseInt(s);if(!f){var l=t(".cointent-widget,.cointent-video");if(l.length>0)for(var c=0;c<l.length;c++){var h=parseInt(t(l[c]).data("publisher-id"));if(h){f=h;break}}}var p=null;if(u.bypass.start>0&&u.bypass.days>0){var d=Math.floor(Date.now()/1e3);u.bypass.start+u.bypass.days*86400>d&&(a=!0,p="bypass")}if(a!==!0){var v=u.getMeterWithCutoff(e,n);p=v[0];if(e=="all")a=v[0]<r;else if(v[0]<r)a=!0;else{var m,g;e=="page"?(m=u.byPage.keys.slice(v[1]),g=i.md5(window.location.pathname)):((!s||!o)&&console.error("meterPass(): Warning, publisherId or articleId missing."),m=u.byArticle.keys.slice(v[1]),g=s+"-"+o),a=m.indexOf(g)>=0}}return i.track("meterPass",{access:a?1:0,type:e,timeframe:String(n),meter:p,publisher:f,user_agent:navigator.userAgent,cointent_client_id:i.cointentClientId,user_id:i.getUserId(),user_id_maybe:i.userIdMaybe}),a},s.meterAccessType=function(e,t,n,r,s){var o=this,u=null;if(o.bypass.start>0&&o.bypass.days>0){var a=Math.floor(Date.now()/1e3);o.bypass.start+o.bypass.days*86400>a&&(u="bypass")}if(u!=="bypass"){var f=o.getMeterWithCutoff(e,t);if(e=="all")u=f[0]<n?"meter":null;else{var l,c,h;e=="page"?(l=o.currentTicks.byPage,c=o.byPage.keys.slice(f[1]),h=i.md5(window.location.pathname)):((!r||!s)&&console.error("meterAccessType(): Warning, publisherId or articleId missing."),l=o.currentTicks.byArticle,c=o.byArticle.keys.slice(f[1]),h=r+"-"+s),c.indexOf(h)>=0&&(l.indexOf(h)<0?u="viewed":u="meter"),u===null&&(u=f[0]<n?"meter":null)}}return u},s.getMeter=function(e,t){var n=this,r=n.getMeterWithCutoff(e,t);return r[0]},s}),ctRequire.define("widget/external",["jquery","utils/utils","utils/meter","utils/adblock"],function(e,t,n,r){var i={};return i.lockCallbacks=[],i.unlockCallbacks=[],i.logoutCallbacks=[],i.loginCallbacks=[],i.justLoggedInCallbacks=[],i.closeCallbacks=[],i.signupCallbacks=[],i.subscribeCallbacks=[],i.spendCallbacks=[],i.passwordSetupCallbacks=[],i.linkCallbacks=[],i.clickCallbacks={subscription:[],spend:[],login:[],customButton:[]},i.popupCloseQueue=[],i.lockStatusCache={},i.loginStatusCache=null,i.init=function(){var e=this;e.setupAPI(),t.emitter.on("accessChange",function(t,n,r){e.fireAccessChangeCallbacks(r,t,n)}),t.emitter.on("logout",function(){e.onLogout()}),t.emitter.on("justloggedin",function(t){e.onJustLoggedIn(t)}),t.emitter.on("login",function(t){e.onLogin(t)}),t.emitter.on("signup",function(t){e.onSignup(t)}),t.emitter.on("subscribesuccess",function(t){e.onSubscribe(t)}),t.emitter.on("spendsuccess",function(t){e.onSpend(t)}),t.emitter.on("setpwsuccess",function(t){e.onPasswordSetup(t)}),t.emitter.on("linksuccess",function(t){e.onLink(t)}),t.emitter.on("customButtonClick",function(t){e.onClickEvent("customButton",t)}),t.emitter.on("subscribeClick",function(t){e.onClickEvent("subscription",t)}),t.emitter.on("checkoutClick",function(t){e.onClickEvent("spend",t)}),t.emitter.on("loginclick",function(t){e.onClickEvent("login",t)}),t.emitter.on("popupClose",function(){e.triggerPopupClose()}),t.emitter.on("close",function(){e.onClose()}),this.bindAutoBindElements()},i.setupAPI=function(){var e=this;window.cointent=window.cointent||{},window.cointent.login=function(e){t.emitter.emit("loginclick",e)},window.cointent.logout=function(){t.emitter.emit("logoutclick")},window.cointent.signup=function(e){t.emitter.emit("signupclick",e)},window.cointent.triggerClose=function(){t.emitter.emit("close")},window.cointent.subscribe=function(e,n,r,i){t.emitter.emit("subscriptionclick",e,n,r,i)},window.cointent.purchase=function(e,n,r,i){e||console.error("publisherId is a required param for cointent.purchase"),r||console.error("'articleTitle' is a required param for cointent.purchase"),n||console.error("'articleId' is a required param for cointent.purchase"),t.emitter.emit("purchaseclick",e,n,i,r)},window.cointent.linkPublisher=function(e){t.emitter.emit("linkpublisherclick",e)},window.cointent.setPassword=function(e,n,r){t.emitter.emit("setpasswordclick",e,n,r)},window.cointent.changePassword=function(e){t.emitter.emit("changepasswordclick",e)},window.cointent.changeEmail=function(e){t.emitter.emit("changeemailclick",e)},window.cointent.getAuthToken=function(){return t.getAuthTokenExternal()},window.cointent.checkLogin=function(e,n){t.isAuthTokenUndefined()?t.insertInitStatus(e,null,function(){n.call(undefined)}):n.call(undefined)},window.cointent.isPopupActive=function(){return t.isPopupActive()},window.cointent.onPopupClose=function(n){t.isFunction(n)?t.isPopupActive()?e.popupCloseQueue.push(n):n.call(undefined):console.warn("cointent.onPopupClose warning: Attempting to queue up non-function on popup close; ignored.")},window.cointent.addLockCallback=function(n){t.isFunction(n)?e.lockCallbacks.push(n):console.warn("cointent.addLockCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addUnlockCallback=function(n){t.isFunction(n)?e.unlockCallbacks.push(n):console.warn("cointent.addLockCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addLogoutCallback=function(n){t.isFunction(n)?e.logoutCallbacks.push(n):console.warn("cointent.addLogoutCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addJustLoggedInCallback=function(n){t.isFunction(n)?e.justLoggedInCallbacks.push(n):console.warn("cointent.addJustLoggedInCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addLoginCallback=function(n){t.isFunction(n)?e.loginCallbacks.push(n):console.warn("cointent.addLoginCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addSignupCallback=function(n){t.isFunction(n)?e.signupCallbacks.push(n):console.warn("cointent.addSignupCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addSubscribeCallback=function(n){t.isFunction(n)?e.subscribeCallbacks.push(n):console.warn("cointent.addSubscribeCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addSpendCallback=function(n){t.isFunction(n)?e.spendCallbacks.push(n):console.warn("cointent.addSpendCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addLinkCallback=function(n){t.isFunction(n)?e.linkCallbacks.push(n):console.warn("cointent.addLinkCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addPasswordSetupCallback=function(n){t.isFunction(n)?e.passwordSetupCallbacks.push(n):console.warn("cointent.addPasswordSetupCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addCloseCallback=function(n){t.isFunction(n)?e.closeCallbacks.push(n):console.warn("cointent.addCloseCallback warning: Attempting to add non-function as callback; ignored.")},window.cointent.addClickCallback=function(n,r){n=="subscription"||n=="spend"||n=="login"||n=="customButton"?t.isFunction(r)?e.clickCallbacks[n].push(r):console.warn("cointent.addClickCallback warning: Attempting to add non-function as callback; ignored."):console.warn('cointent.addClickCallback warning: Event name "'+n+'" is invalid; ignored.')},window.cointent.getGating=function(e,n,r,i){t.getGating(e,n,r,i)},window.cointent.getMeter=function(e,t){return n.getMeter(e,t)},window.cointent.meterPass=function(e,t,r,i,s){return n.meterPass(e,t,r,i,s)},window.cointent.meterAccessType=function(e,t,r,i,s){return n.meterAccessType(e,t,r,i,s)},window.cointent.meterTick=function(){return n.meterTick()},window.cointent.meterSetBypass=function(e){return n.setBypass(e)},window.cointent.meterClearBypass=function(){return n.clearBypass()},window.cointent.isAdBlocked=function(e,n){return t.isAdBlockedPublisher(e,n)},window.cointent.initAdBlock=function(e,t,n,i,s){return r.initAdBlockExternal(e,t,n,i,s)},window.cointent.adBlockRenderComplete=function(){t.emitter.emit("adBlockRenderComplete")},window.cointent.overrideAdBlock=function(e){r.setOverrideValue("adBlock",e)},window.cointent.showWhitelist=function(){return r.renderWhitelist()},window.cointent.buildWidget=function(){t.emitter.emit("setupWidgetAfterReload")}},i.onLogout=function(){var e=this;e.fireAccessChangeCallbacks(!1),e.fireLogoutCallbacks(),e.loginStatusCache=null},i.onLogin=function(e){var t=this;if(t.loginStatusCache!==null)return;e&&e.authResponse&&e.authResponse.userId?t.loginStatusCache=e.authResponse.userId:t.loginStatusCache=999999999,t.fireLoginCallbacks()},i.onJustLoggedIn=function(e){var t=this;t.fireJustLoggedInCallbacks()},i.onSignup=function(e){var t=this;t.fireSignupCallbacks()},i.onSubscribe=function(e){var t=this;t.fireSubscribeCallbacks(e.planId)},i.onSpend=function(e){var t=this;t.fireSpendCallbacks(e.gating.publisherId,e.gating.articleId)},i.onPasswordSetup=function(e){var t=this;t.firePasswordSetupCallbacks()},i.onLink=function(e){var t=this;t.fireLinkCallbacks(e.authResponse.publisherId)},i.onClose=function(){var e=this;e.fireCloseCallbacks()},i.onClickEvent=function(e,t){var n=this;n.fireClickCallbacks(e)},i.triggerPopupClose=function(){var e=this;for(var n=0;n<e.popupCloseQueue.length;n++)t.isFunction(e.popupCloseQueue[n])&&e.popupCloseQueue[n].call(undefined);e.popupCloseQueue=[]},i.fireAccessChangeCallbacks=function(e,t,n){var r=this;if(t&&n){if(r.lockStatusCache[t+"-"+n]===e)return;r.lockStatusCache[t+"-"+n]=e,r.fireAccessChangeCallbacksHelper(t,n,e)}else for(var i in r.lockStatusCache){var s=i.split("-")[0],o=i.split("-")[1];if(r.lockStatusCache[i]===e)continue;r.lockStatusCache[i]=e,r.fireAccessChangeCallbacksHelper(s,o,e)}},i.fireAccessChangeCallbacksHelper=function(e,n,r){var i=this,s;if(!r)for(s=0;s<i.lockCallbacks.length;s++)t.isFunction(i.lockCallbacks[s])&&i.lockCallbacks[s].call(undefined,e,n);else for(s=0;s<i.unlockCallbacks.length;s++)t.isFunction(i.unlockCallbacks[s])&&i.unlockCallbacks[s].call(undefined,e,n)},i.fireCloseCallbacks=function(){var e=this,n;for(n=0;n<e.closeCallbacks.length;n++)t.isFunction(e.closeCallbacks[n])&&e.closeCallbacks[n].call(undefined)},i.fireLogoutCallbacks=function(){var e=this,n;for(n=0;n<e.logoutCallbacks.length;n++)t.isFunction(e.logoutCallbacks[n])&&e.logoutCallbacks[n].call(undefined)},i.fireJustLoggedInCallbacks=function(){var e=this;for(var n=0;n<e.justLoggedInCallbacks.length;n++)t.isFunction(e.justLoggedInCallbacks[n])&&e.justLoggedInCallbacks[n].call(undefined)},i.fireLoginCallbacks=function(){var e=this;for(var n=0;n<e.loginCallbacks.length;n++)t.isFunction(e.loginCallbacks[n])&&e.loginCallbacks[n].call(undefined)},i.fireSignupCallbacks=function(){var e=this;for(var n=0;n<e.signupCallbacks.length;n++)t.isFunction(e.signupCallbacks[n])&&e.signupCallbacks[n].call(undefined)},i.fireSubscribeCallbacks=function(e){var n=this;for(var r=0;r<n.subscribeCallbacks.length;r++)t.isFunction(n.subscribeCallbacks[r])&&n.subscribeCallbacks[r].call(undefined,e)},i.fireSpendCallbacks=function(e,n){var r=this;for(var i=0;i<r.spendCallbacks.length;i++)t.isFunction(r.spendCallbacks[i])&&r.spendCallbacks[i].call(undefined,e,n)},i.firePasswordSetupCallbacks=function(){var e=this;for(var n=0;n<e.passwordSetupCallbacks.length;n++)t.isFunction(e.passwordSetupCallbacks[n])&&e.passwordSetupCallbacks[n].call(undefined)},i.fireLinkCallbacks=function(e){var n=this;for(var r=0;r<n.linkCallbacks.length;r++)t.isFunction(n.linkCallbacks[r])&&n.linkCallbacks[r].call(undefined,e)},i.fireClickCallbacks=function(e){var n=this;for(var r=0;r<n.clickCallbacks[e].length;r++)t.isFunction(n.clickCallbacks[e][r])&&n.clickCallbacks[e][r].call(undefined)},i.bindAutoBindElements=function(){e(".cointent_external_signup").on("click",window.cointent.signup),e(".cointent_external_login").on("click",function(t){var n=e(t.currentTarget).data("publisher");window.cointent.login(n)})},i.init(),i});var path={eventemitter:"utils/events"};typeof window.jQuery=="function"?ctRequire.define("jquery",[],function(){return jQuery.noConflict(!1)}):path.jquery="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min",ctRequire.requirejs.config({shim:{eventemitter:{exports:"EventEmitter2"},jquery:{exports:"jQuery",validate:function(){return window.jQuery}}},findNestedDependencies:!0,paths:path}),window.hKPY2Pc8kQ9W9d0W=1,window.cointent=window.cointent||{},window.cointent.readyFuncsList=[],window.cointent.isReady=!1,window.cointent.ready=function(e){window.cointent.isReady?e.call(undefined):window.cointent.readyFuncsList.push(e)},ctRequire.define("cointent",["require","utils/dom_ready","jquery-private","widget/text","widget/widget","widget/linkbtn","widget/edgeworth","utils/utils","config/config","utils/adblock","utils/track","utils/meter","widget/external"],function(e){var t=e("utils/dom_ready"),n=e("jquery-private"),r=e("widget/text"),i=e("widget/widget"),s=e("widget/linkbtn"),o=e("widget/edgeworth"),u=e("utils/utils"),a=e("config/config"),f=e("utils/adblock"),l=e("utils/track"),c=e("utils/meter"),h=e("widget/external"),p={};p.STATUS_ACTIVE="active",p.STATUS_EXPIRED="expired",p.STATUS_NOSESSION="nosession",p.STATUS_CREATESUCCESS="createsuccess",p.STATUS_LOGINSUCCESS="loginsuccess",p.STATUS_LOGOUTSUCCESS="logoutsuccess",p.STATUS_SETPWSUCCESS="setpwsuccess",p.STATUS_SPENDSUCCESS="spendsuccess",p.STATUS_SUBSCRIBESUCCESS="subscribesuccess",p.STATUS_LINKSUCCESS="linksuccess",p.STATUS_CLOSEPOPUP="closePopup",p.STATUS_INVALID="invalid",p.STATUS_ACTIVATELIGHTBOX="activateLightbox",p.STATUS_CHANGELIGHTBOX="changeLightbox",p.init=function(e){var t=this,i;u.loadJquery();if(t.initialized)return;t.initialized=!0,e||t.bindEvents(),n("head").append('<link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Lato:300,400,700,900">'),u.manageClientCookie(),u.manageSessionReferCookie(),u.addPublisherData(),t.jq=n;var f=function(e){n=t.jq,u.receiveMessage.call(t,e)};window.addEventListener?window.addEventListener("message",f,!1):window.attachEvent&&window.attachEvent("onmessage",f,!1);var h=n("head").find('link[href$="cointent.com/style.css"]');h.length<=0&&n("head").prepend("<link rel='stylesheet' type='text/css' href='"+a.CONNECT_BASE+"/style.css' />"),r.init(),s.init(),o.init(),c.init();while(window.cointent.readyFuncsList.length>0)i=window.cointent.readyFuncsList.shift(),i.call(undefined);window.cointent.isReady=!0,l.setup(),p.setupDefaultAdBlock()},p.setupDefaultAdBlock=function(){f.init();var e=n(".cointent-gumshoe"),t=0;e.length>0?t=e.data("publisher-id"):typeof window.cointent_tracking_data!="undefined"&&window.cointent_tracking_data.publisherId?t=window.cointent_tracking_data.publisherId:t=n(".cointent-widget, .cointent-video").data("publisher-id"),t?e.length>0?u.isAdBlockedPublisher(t,function(e){f.activate(e),l.init(e)},function(e){l.init(e)}):u.isAdBlocked(function(e){l.init(e)}):l.init(0)},p.bindEvents=function(){var e=this;u.emitter.on("focus",function(){e.focusWindow()}),u.emitter.on("unlock",function(t,n){e.popupUnlock(t,n)}),u.emitter.on("subscribe",function(t,n){e.popupSubscribe(n)}),u.emitter.on("logoutclick",function(){e.doLogout()}),u.emitter.on("loginclick",function(t,n){e.popupLogin(t,n)}),u.emitter.on("signupclick",function(t){e.popupSignup(t)}),u.emitter.on("subscriptionclick",function(t,n,r,i){e.popupSmartSubscribe(t,n,r,i)}),u.emitter.on("purchaseclick",function(t,r,i,s){u.emitter.emit("checkoutClick");var o=n('<div data-article-title="'+s+'" data-publisher-id="'+t+'" data-article-id="'+r+'" data-price="'+i+'"></div>');u.track("click",{component:"widget",page:"buy_button",url:window.location.href,publisher:t,article:r,price:i,balance:u.getUserBalance(),user_agent:navigator.userAgent,cointent_client_id:u.cointentClientId,user_id:u.getUserId(),user_id_maybe:u.userIdMaybe}),e.popupUnlock(!1,o)}),u.emitter.on("setpasswordclick",function(t,n,r){e.popupResetPassword(t,n,r)}),u.emitter.on("changepasswordclick",function(t){e.popupChangePassword(t)}),u.emitter.on("changeemailclick",function(t){e.popupChangeEmail(t)}),u.emitter.on("upgradesubclick",function(t){e.popupUpgradeSubscription(t)}),u.emitter.on("manageclick",function(t){e.popupManageSubscription(t);var r=document.getElementById("cointent_lightbox");r&&n(r).removeClass("cointent_signup cointent_signup_large").addClass("cointent_manage")}),u.emitter.on("linkpublisherclick",function(t){e.popupLinkPublisher(t)}),u.emitter.on("setupWidgetAfterReload",function(){e.initialized=!1,e.init(!0)})},p.handleResponse=function(e){var t=this;e&&n.each(e,function(n){t.messageDataHandlers[n]&&t.messageDataHandlers[n](t,e)}),n(".buy_widget").css("opacity",1)},p.messageDataHandlers={gating:function(e,t){var r=n("#cointent_"+t.gating.publisherId+"_"+t.gating.articleId),i=r.siblings(".cointent-widget,.cointent-gumshoe,.cointent-edgeworth,.cointent-video");e.processGatingStatus(t,i)},adBlock:function(e,t){u.emitter.emit("updateAdBlock",t.adBlock)},gsMode:function(e,t){u.emitter.emit("updateGumshoeMode",t.gsMode)},showSubscription:function(e,t){u.emitter.emit("updateWidget",t.showSubscription)},pricing:function(e,t){var r=n("#cointent_"+t.pricing.publisherId+"_"+t.pricing.articleId);e.processPricingStatus(t,r),u.track("perf",{page:"client_loaded",user_agent:navigator.userAgent,component:"widget",publisher:t.pricing.publisherId,article:t.pricing.articleId,cointent_client_id:u.cointentClientId,user_id:t.authResponse?t.authResponse.userId:null,user_id_maybe:u.userIdMaybe,time:Date.now()-window.cointent_startTime,type:"widget_full_load"})},justLoggedIn:function(e,t){u.emitter.emit("justloggedin",t.justLoggedIn)},authResponse:function(e,t){u.setAuth(t.authResponse),u.userIdMaybe=t.authResponse.userId,u.emitter.emit("updateAuthResponse",t.authResponse),t.linkToken&&(u.setLinkToken(t.linkToken),u.emitter.emit("updateLinkToken",t.authResponse.publisherId))},expVariants:function(e,t){u.addExperimentVariants(t.expVariants),u.emitter.emit("updateWidget",{experiments:!0})},cookie:function(e){e.cookieExists=!0},trackParams:function(e,t){u.addCommonTrackParams(t.trackParams)},track:function(e,t){t.trackParams&&u.addCommonTrackParams(t.trackParams),e.processTracking(t.track)},status:function(e,t){var r=null;switch(t.status){case e.STATUS_LOGINSUCCESS:e.closePopup(),i.reenableWidgetButtons();case e.STATUS_ACTIVE:case e.STATUS_CREATESUCCESS:case e.STATUS_SETPWSUCCESS:case e.STATUS_SPENDSUCCESS:case e.STATUS_LINKSUCCESS:u.setAuth(t.authResponse),t.status===e.STATUS_CREATESUCCESS&&u.emitter.emit("signup",t),t.status===e.STATUS_SETPWSUCCESS&&u.emitter.emit("setpwsuccess",t),t.status===e.STATUS_SPENDSUCCESS&&u.emitter.emit("spendsuccess",t),t.status==e.STATUS_LINKSUCCESS&&(u.setLinkToken(t.linkToken),u.emitter.emit("linksuccess",t)),e.loginResponse(t),e.queryGating(t);break;case e.STATUS_SUBSCRIBESUCCESS:u.emitter.emit("subscribesuccess",t);break;case e.STATUS_NOSESSION:u.setAuth(null);break;case e.STATUS_LOGOUTSUCCESS:u.setAuth(null),u.emitter.emit("logout",t);break;case e.STATUS_CLOSEPOPUP:e.closePopup();break;case e.STATUS_ACTIVATELIGHTBOX:r=document.getElementById("cointent_lightbox"),r&&n(r).addClass("active").css("display","block");break;case e.STATUS_CHANGELIGHTBOX:r=document.getElementById("cointent_lightbox"),r&&n(r).removeClass("cointent_signup cointent_signup_only cointent_signup_large cointent_login cointent_manage cointent_purchase_success cointent_login_large").addClass(t.cssClass);break;case e.STATUS_EXPIRED:u.setAuth(null),t.idMaybe&&(u.userIdMaybe=t.idMaybe);break;case e.STATUS_INVALID:u.emitter.emit("invalidateWidget",t);break;default:}},init:function(e,t){t.authResponse?u.setAuth(t.authResponse):u.setAuth(null),u.emitter.emit("initcomplete")}},p.popupLogin=function(e,t){var n="newLogin?";e&&(n+="publisher="+e,t&&(n+="&article="+t),n+="&"),n+="sref="+encodeURIComponent(u.sessionReferCookie),n+="&ref="+encodeURIComponent(document.referrer),n+="&sutm="+encodeURIComponent(u.sessionUtmCookie),n+="&utm="+encodeURIComponent(u.articleUtmCookie),u.openWindow(n,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupLogout=function(e){u.openWindow("logout",i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupSignup=function(e){var t="newSignup?";e&&(t+="publisher="+e+"&"),window.mixpanel&&window.mixpanel.get_distinct_id&&(t+="mixpanel_distinct_id="+window.mixpanel.get_distinct_id()),u.openWindow(t,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupUpgradeSubscription=function(e){var t=e.data("show-subscription"),n="";t&&(n="&subs="+t),u.openWindow("subscription/upgrade?publisher="+e.data("publisher-id")+"&article="+e.data("article-id")+n),i.ajaxSpinnerOff()},p.popupManageSubscription=function(e){u.openWindow("subscription/manage?publisher="+e.data("publisher-id")+"&article="+e.data("article-id")),i.ajaxSpinnerOff()},p.pixelLogout=function(){n("iframe#cointent_logout").remove();var e=n("<iframe></iframe>").attr({src:a.SITE_URI+"/logout?",id:"cointent_logout",width:1,height:1,border:0,frameborder:0,style:"width:1px !important;height:1px !important; display:block !important;"}),t=n("#cointent_action_iframe");t.length?e.insertAfter(t):n("body").append(e),i.ajaxSpinnerOff(),u.enableButton(n(".cointent_logout"))},p.doLogout=function(){var e=this;u.useLightbox()===!1?e.popupLogout():e.pixelLogout()},p.popupUnlock=function(e,t){var r=this,s=t.data("price"),o=t.data("publisher-id"),f=t.data("article-id"),l=t.data("article-title");if(u.auth===undefined||u.auth===null||s>u.auth.accountBalance||e){i.ajaxSpinnerOff();var c="",h="",p=u.getLinkEmail(t);if(p){c="lemail="+encodeURIComponent(p);var d=u.getLinkToken(t);d&&(c+="&ltoken="+encodeURIComponent(d)),c+="&"}window.mixpanel&&window.mixpanel.get_distinct_id&&(h="mixpanel_distinct_id="+window.mixpanel.get_distinct_id()+"&");var v="unlock/publisher/"+o+"/article/"+f+"?"+c+h+"title="+encodeURIComponent(l);v+="&sref="+encodeURIComponent(u.sessionReferCookie),v+="&ref="+encodeURIComponent(document.referrer),v+="&sutm="+encodeURIComponent(u.sessionUtmCookie),v+="&utm="+encodeURIComponent(u.articleUtmCookie),v+="&pd="+encodeURIComponent(u.publisherDataForServer),u.openWindow(v,i.reenableWidgetButtons)}else{var m=u.getAuthToken();n.extend(m,{title:l,sessionref:"",articleref:"",sessionutm:u.sessionUtmCookie,articleutm:u.articleUtmCookie,pd:u.publisherDataForServer}),u.articlePromoCodes[f]&&(m.promocode=u.articlePromoCodes[f]),u.commonTrackParams.session_refer&&(m.sessionref=u.commonTrackParams.session_refer),u.commonTrackParams.article_refer&&(m.articleref=u.commonTrackParams.article_refer);var g="/purchase/publisher/"+o+"/article/"+f,y;n.ajax({type:"POST",url:window.location.protocol+a.API_BASE+g,async:!1,data:m,success:function(e){e===""?y={error:"Empty response returned"}:(y=n.parseJSON(e),e||(y={error:"Invalid information returned"}))},error:function(e){u.debuggerPrint("API ERROR: "+e.responseText),y=JSON.parse(e.responseText)}}),r.purchaseCallback(y,t)}},p.purchaseCallback=function(e,t){var n=this;e.error?(u.debuggerPrint("Purchase Callback: "+e.error.code+" "+e.error.message),n.popupUnlock(!0,t)):(i.ajaxSpinnerOff(),u.emitter.emit("spendsuccess",e),n.loginResponse(e),n.processGatingStatus(e,t))},p.popupSubscribe=function(e){var t=e.data("publisher-id"),n=e.data("article-id"),r=e.data("article-title"),s=e.data("show-subscription");i.ajaxSpinnerOff();var o="";window.mixpanel&&window.mixpanel.get_distinct_id&&(o="mixpanel_distinct_id="+window.mixpanel.get_distinct_id());var a="subscribe/publisher/"+t+"/article/"+n+"?"+o+"&title="+encodeURIComponent(r);a+="&subs="+s,a+="&sref="+encodeURIComponent(u.sessionReferCookie),a+="&ref="+encodeURIComponent(document.referrer),a+="&sutm="+encodeURIComponent(u.sessionUtmCookie),a+="&utm="+encodeURIComponent(u.articleUtmCookie),u.openWindow(a,i.reenableWidgetButtons)},p.popupSmartSubscribe=function(e,t,n,r){var s="smartSubscribe?";e&&(s+="publisher="+e+"&",t&&(s+="article="+t+"&")),n&&(s+="subs="+n.join()+"&"),r&&(s+="select="+r+"&"),window.mixpanel&&window.mixpanel.get_distinct_id&&(s+="mixpanel_distinct_id="+window.mixpanel.get_distinct_id()),u.openWindow(s,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupResetPassword=function(e,t,n){var r="resetPassword?email="+encodeURIComponent(t)+"&resetCode="+n+"&publisher="+e+"&type=set";u.openWindow(r,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupChangePassword=function(e){var t="changePassword?publisher="+e;u.openWindow(t,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupChangeEmail=function(e){var t="changeEmail?publisher="+e;u.openWindow(t,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.popupLinkPublisher=function(e){var t="u/linkPublisher?";e&&(t+="publisher="+e),u.openWindow(t,i.reenableWidgetButtons),i.ajaxSpinnerOff()},p.closePopup=function(){if(u.popupWindow){if(u.useLightbox()===!1)u.popupWindow.close();else{var e=function(){u.emitter.emit("autoClosePopup"),u.popupWindow&&u.popupWindow.remove(),n("#cointent_lightbox").remove(),n(".cointent_modal").remove(),n("body").removeClass("cointent_modal_open")};setTimeout(e,400),u.popupWindow.on("transitionend webkitTransitionEnd oTransitionEnd otransitionend MSTransitionEnd",e),u.popupWindow.css({opacity:0})}u.popupWindow=null}},p.processTracking=function(e){var t,n=0;for(n;n<e.length;n++)e[n].event&&(t=e[n].params||{},t.user_agent=navigator.userAgent,t.cointent_client_id=u.cointentClientId,t.user_id=u.getUserId(),t.user_id_maybe=u.userIdMaybe,u.track(e[n].event,t))},p.lastGatingUpdate=null,p.processGatingStatus=function(e,t){var n=this,r=e.gating;if(r&&r.publisherId&&r.articleId&&r.timestamp){var i=r.publisherId,s=r.articleId;e.authResponse&&u.setAuth(e.authResponse),u.emitter.emit("updateGating",r);if(!n.lastGatingUpdate||r.timestamp>=n.lastGatingUpdate){n.lastGatingUpdate=r.timestamp;var o=!!r.access,a,f,l;t&&(a=t.data("reload-full-page"),f=t.data("refresh-full-page"),l=t.data("client-side-locking")),u.emitter.emit("accessChange",i,s,o,e,a,f,l)}}},p.focusWindow=function(){this.popupWindow&&this.popupWindow.focus&&this.popupWindow.focus()},p.loginResponse=function(e){var t=this;u.emitter.emit("login",e),window.mixpanel&&(e.status===t.STATUS_CREATESUCCESS?window.mixpanel.alias(e.authResponse.userId):window.mixpanel.identify(e.authResponse.userId))},p.queryGating=function(e){var t=this,r=0,i=u.getAuthToken(),s,o="",a=n(".cointent-widget,.cointent-gumshoe,.cointent-edgeworth,.cointent-video");if(a.length===0){var f=n("#cointent_td").data("article-id"),l=n("#cointent_td").data("publisher-id");o="/gating/publisher/"+l+"/article/"+f,u.apiCall("GET",o,i,function(e){return function(n){t.processGatingStatus(n,e)}}())}for(r;r<a.length;r++)s=n(a[r]),o="/gating/publisher/"+s.data("publisher-id")+"/article/"+s.data("article-id"),u.apiCall("GET",o,i,function(e){return function(n){t.processGatingStatus(n,e)}}(s))},p.processPricingStatus=function(e,t){var n=e.pricing.articleId,r=e.pricing.price;u.articlePrices[n]=r,e.pricing.promoCode&&(u.articlePromoCodes[n]=e.pricing.promoCode),u.emitter.emit("updateWidget",{elem:t,publisherId:e.pricing.publisherId,articleId:e.pricing.articleId,price:r,publisherCurrency:e.pricing.publisherCurrency,expiry:e.pricing.expiry,buyVerb:e.pricing.buyVerb,subscriptionVerb:e.pricing.subscriptionVerb,buyButtonOn:e.pricing.buyButtonOn})};var d=n(".cointent-widget, .cointent-gumshoe");return d.length>0?p.init():t(function(){p.init()}),{version:"0.2, jQuery version is: "+n.fn.jquery,cointent:p}}),ctRequire.require(["cointent"]);